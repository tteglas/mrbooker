/*
@license
dhtmlxScheduler v.5.0.0 Stardard
This software is covered by GPL license. You also can obtain Commercial or Enterprise license to use it in non-GPL project - please contact sales@dhtmlx.com. Usage without proper license is prohibited.
(c) Dinamenta, UAB.
*/
function dtmlXMLLoaderObject(n,t,i,r){return this.xmlDoc="",this.async="undefined"!=typeof i?i:!0,this.onloadAction=n||null,this.mainObject=t||null,this.waitCall=null,this.rSeed=r||!1,this}function convertStringToBoolean(n){switch("string"==typeof n&&(n=n.toLowerCase()),n){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(n){return-1!=n.indexOf("?")?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function _dhtmlxError(){return this.catches||(this.catches=[]),this}function dhtmlXHeir(n,t){for(var i in t)"function"==typeof t[i]&&(n[i]=t[i]);return n}window.dhtmlXScheduler=window.scheduler={version:"5.0.0"};window.dhtmlx||(dhtmlx=function(n){for(var t in n)dhtmlx[t]=n[t];return dhtmlx});dhtmlx.extend_api=function(n,t,i){var r=window[n];r&&(window[n]=function(n){var u,i;if(n&&"object"==typeof n&&!n.tagName){u=r.apply(this,t._init?t._init(n):arguments);for(i in dhtmlx)t[i]&&this[t[i]](dhtmlx[i]);for(i in n)t[i]?this[t[i]](n[i]):0===i.indexOf("on")&&this.attachEvent(i,n[i])}else u=r.apply(this,arguments);return t._patch&&t._patch(this),u||this},window[n].prototype=r.prototype,i&&dhtmlXHeir(window[n].prototype,i))};dhtmlxAjax={get:function(n,t){var i=new dtmlXMLLoaderObject(!0);return i.async=arguments.length<3,i.waitCall=t,i.loadXML(n),i},post:function(n,t,i){var r=new dtmlXMLLoaderObject(!0);return r.async=arguments.length<4,r.waitCall=i,r.loadXML(n,!0,t),r},getSync:function(n){return this.get(n,null,!0)},postSync:function(n,t){return this.post(n,t,null,!0)}};window.dtmlXMLLoaderObject=dtmlXMLLoaderObject;dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(n){var t=!0;return this.check=function(){if(n&&n.onloadAction&&(!n.xmlDoc.readyState||4==n.xmlDoc.readyState)){if(!t)return;t=!1;dtmlXMLLoaderObject.count++;"function"==typeof n.onloadAction&&n.onloadAction(n.mainObject,null,null,null,n);n.waitCall&&(n.waitCall.call(this,n),n.waitCall=null)}},this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(n,t){var i,r,t;return(this.xmlDoc.responseXML?(r=this.xmlDoc.responseXML.getElementsByTagName(n),0===r.length&&-1!=n.indexOf(":")&&(r=this.xmlDoc.responseXML.getElementsByTagName(n.split(":")[1])),i=r[0]):i=this.xmlDoc.documentElement,i)?(this._retry=!1,i):!this._retry&&_isIE?(this._retry=!0,t=this.xmlDoc,this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(n,t)):(dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),document.createElement("div"))};dtmlXMLLoaderObject.prototype.loadXMLString=function(n,t){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(n);else{var i=new DOMParser;this.xmlDoc=i.parseFromString(n,"text/xml")}t||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))};dtmlXMLLoaderObject.prototype.loadXML=function(n,t,i,r){this.rSeed&&(n+=(-1!=n.indexOf("?")?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=n;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this));"string"==typeof t?this.xmlDoc.open(t,n,this.async):this.xmlDoc.open(t?"POST":"GET",n,this.async);r?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):t&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(i);this.async||new this.waitLoadFunction(this)()};dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,this.loadXML=null,this.loadXMLString=null,this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null,null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(n){for(var r,i={},t=0;t<n.attributes.length;t++)i[n.attributes[t].name]=n.attributes[t].value;for(i._tagvalue=n.firstChild?n.firstChild.nodeValue:"",t=0;t<n.childNodes.length;t++)r=n.childNodes[t].tagName,r&&(i[r]||(i[r]=[]),i[r].push(this.xmlNodeToJSON(n.childNodes[t])));return i};window.dhtmlDragAndDropObject=dhtmlDragAndDropObject;dhtmlDragAndDropObject.prototype.removeDraggableItem=function(n){n.onmousedown=null;n.dragStarter=null;n.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(n,t){n.onmousedown=this.preCreateDragCopy;n.dragStarter=t;this.addDragLanding(n,t)};dhtmlDragAndDropObject.prototype.addDragLanding=function(n,t){n.dragLanding=t};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(n){if(!n&&!window.event||2!=(n||event).button)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(n),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),n&&n.preventDefault?(n.preventDefault(),!1):!1)};dhtmlDragAndDropObject.prototype.callDrag=function(n){var t,i,u,r,f;if(n||(n=window.event),t=window.dhtmlDragAndDrop,!((new Date).valueOf()-t.downtime<100)){if(!t.dragNode){if(!t.waitDrag)return t.stopDrag(n,!0);if(t.dragNode=t.dragStartObject._createDragNode(t.dragStartNode,n),!t.dragNode)return t.stopDrag();t.dragNode.onselectstart=function(){return!1};t.gldragNode=t.dragNode;document.body.appendChild(t.dragNode);document.body.onmouseup=t.stopDrag;t.waitDrag=0;t.dragNode.pWindow=window;t.initFrameRoute()}t.dragNode.parentNode!=window.document.body&&t.gldragNode&&(i=t.gldragNode,t.gldragNode.old&&(i=t.gldragNode.old),i.parentNode.removeChild(i),u=t.dragNode.pWindow,(i.pWindow&&i.pWindow.dhtmlDragAndDrop.lastLanding&&i.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(i.pWindow.dhtmlDragAndDrop.lastLanding),_isIE)?(r=document.createElement("div"),r.innerHTML=t.dragNode.outerHTML,t.dragNode=r.childNodes[0]):t.dragNode=t.dragNode.cloneNode(!0),t.dragNode.pWindow=window,t.gldragNode.old=t.dragNode,document.body.appendChild(t.dragNode),u.dhtmlDragAndDrop.dragNode=t.dragNode);t.dragNode.style.left=n.clientX+15+(t.fx?-1*t.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";t.dragNode.style.top=n.clientY+3+(t.fy?-1*t.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";f=n.srcElement?n.srcElement:n.target;t.checkLanding(f,n)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(n){var u;if(window.name){for(var t=parent.frames[window.name].frameElement.offsetParent,i=0,r=0;t;)i+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;if(parent.dhtmlDragAndDrop&&(u=parent.dhtmlDragAndDrop.calculateFramePosition(1),i+=1*u.split("_")[0],r+=1*u.split("_")[1]),n)return i+"_"+r;this.fx=i;this.fy=r}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(n,t){n&&n.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=n,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,t.clientX,t.clientY,t),this.lastLanding_scr=_isIE?t.srcElement:t.target):n&&"BODY"!=n.tagName?this.checkLanding(n.parentNode,t):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,t.clientX,t.clientY,t),this.lastLanding=0,this._onNotFound&&this._onNotFound())};dhtmlDragAndDropObject.prototype.stopDrag=function(n,t){var i=window.dhtmlDragAndDrop,r;t||(i.stopFrameRoute(),r=i.lastLanding,i.lastLanding=null,r&&r.dragLanding._drag(i.dragStartNode,i.dragStartObject,r,_isIE?event.srcElement:n.target));i.lastLanding=null;i.dragNode&&i.dragNode.parentNode==document.body&&i.dragNode.parentNode.removeChild(i.dragNode);i.dragNode=0;i.gldragNode=0;i.fx=0;i.fy=0;i.dragStartNode=0;i.dragStartObject=0;document.body.onmouseup=i.tempDOMU;document.body.onmousemove=i.tempDOMM;i.tempDOMU=null;i.tempDOMM=null;i.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(n){n&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var t=0;t<window.frames.length;t++)try{window.frames[t]!=n&&window.frames[t].dhtmlDragAndDrop&&window.frames[t].dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=n&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(n,t){n&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=n.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=n.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=n.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=n.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&t&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=n&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(r){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=n&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!n||t?1:0)}catch(r){}};_isFF=!1;_isIE=!1;_isOpera=!1;_isKHTML=!1;_isMacOS=!1;_isChrome=!1;_FFrv=!1;_KHTMLrv=!1;_OperaRv=!1;-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,-1==navigator.appVersion.indexOf("MSIE 8.0")&&-1==navigator.appVersion.indexOf("MSIE 9.0")&&-1==navigator.appVersion.indexOf("MSIE 10.0")||"BackCompat"==document.compatMode||(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]));dtmlXMLLoaderObject.prototype.doXPath=function(n,t,i,r){var u,f,e,o,s;if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(n,t);if(_isIE)return t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),i&&t.setProperty("SelectionNamespaces","xmlns:xsl='"+i+"'"),"single"==r?t.selectSingleNode(n):t.selectNodes(n)||new Array(0);if(u=t,t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),-1!=t.nodeName.indexOf("document")?u=t:(u=t,t=t.ownerDocument),f=XPathResult.ANY_TYPE,"single"==r&&(f=XPathResult.FIRST_ORDERED_NODE_TYPE),e=[],o=t.evaluate(n,u,function(){return i},f,null),f==XPathResult.FIRST_ORDERED_NODE_TYPE)return o.singleNodeValue;for(s=o.iterateNext();s;)e[e.length]=s,s=o.iterateNext();return e};_dhtmlxError.prototype.catchError=function(n,t){this.catches[n]=t};_dhtmlxError.prototype.throwError=function(n,t,i){return this.catches[n]?this.catches[n](n,t,i):this.catches.ALL?this.catches.ALL(n,t,i):(window.alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]),null)};window.dhtmlxError=new _dhtmlxError;dtmlXMLLoaderObject.prototype.doXPathOpera=function(n,t){var i=n.replace(/[\/]+/gi,"/").split("/"),u=null,r=1;if(!i.length)return[];if("."==i[0])u=[t];else{if(""!==i[0])return[];u=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(i[r].replace(/\[[^\]]*\]/g,""));r++}for(r;r<i.length;r++)u=this._getAllNamedChilds(u,i[r]);return-1!=i[r-1].indexOf("[")&&(u=this._filterXPath(u,i[r-1])),u};dtmlXMLLoaderObject.prototype._filterXPath=function(n,t){for(var r=[],t=t.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),i=0;i<n.length;i++)n[i].getAttribute(t)&&(r[r.length]=n[i]);return r};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(n,t){var u=[],i,r;for(_isKHTML&&(t=t.toUpperCase()),i=0;i<n.length;i++)for(r=0;r<n[i].childNodes.length;r++)_isKHTML?n[i].childNodes[r].tagName&&n[i].childNodes[r].tagName.toUpperCase()==t&&(u[u.length]=n[i].childNodes[r]):n[i].childNodes[r].tagName==t&&(u[u.length]=n[i].childNodes[r]);return u};"undefined"==typeof dhtmlxEvent&&(window.dhtmlxEvent=function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)});dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(n,t,i){i||(i=this.xslDoc);i.responseXML&&(i=i.responseXML);var r=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+n+"']",i,"http://www.w3.org/1999/XSL/Transform","single");r&&(r.firstChild.nodeValue=t)};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(n,t){n||(n=this.xslDoc);n.responseXML&&(n=n.responseXML);t||(t=this.xmlDoc);t.responseXML&&(t=t.responseXML);var i;if(_isIE){i=new ActiveXObject("Msxml2.DOMDocument.3.0");try{t.transformNodeToObject(n,i)}catch(r){i=t.transformNode(n)}}else this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(n)),i=this.XSLProcessor.transformToDocument(t);return i};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(n,t){var i=this.doXSLTransToObject(n,t);return"string"==typeof i?i:this.doSerialization(i)};dtmlXMLLoaderObject.prototype.doSerialization=function(n){if(n||(n=this.xmlDoc),n.responseXML&&(n=n.responseXML),_isIE)return n.xml;var t=new XMLSerializer;return t.serializeToString(n)};dhtmlxEventable=function(n){n.attachEvent=function(n,t,i){return n="ev_"+n.toLowerCase(),this[n]||(this[n]=new this.eventCatcher(i||this)),n+":"+this[n].addEvent(t)};n.callEvent=function(n,t){return n="ev_"+n.toLowerCase(),this[n]?this[n].apply(this,t):!0};n.checkEvent=function(n){return!!this["ev_"+n.toLowerCase()]};n.eventCatcher=function(n){var t=[],i=function(){for(var u,r=!0,i=0;i<t.length;i++)t[i]&&(u=t[i].apply(n,arguments),r=r&&u);return r};return i.addEvent=function(n){return"function"!=typeof n&&(n=eval(n)),n?t.push(n)-1:!1},i.removeEvent=function(n){t[n]=null},i};n.detachEvent=function(n){if(n){var t=n.split(":");this[t[0]].removeEvent(t[1])}};n.detachAllEvents=function(){for(var n in this)0===n.indexOf("ev_")&&(this.detachEvent(n),this[n]=null)};n=null};scheduler.event=window.dhtmlxEvent;scheduler.eventRemove=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)},function(){function n(n){var i=!1,r=!1,u,t,f;return window.getComputedStyle?(u=window.getComputedStyle(n,null),i=u.display,r=u.visibility):n.currentStyle&&(i=n.currentStyle.display,r=n.currentStyle.visibility),t=!1,f=scheduler._locate_css({target:n},"dhx_form_repeat",!1),f&&(t=!("0px"!=f.style.height)),t=t||!n.offsetHeight,"none"!=i&&"hidden"!=r&&!t}function t(n){return!isNaN(n.getAttribute("tabindex"))&&1*n.getAttribute("tabindex")>=0}function i(n){return{a:!0,area:!0}[n.nodeName.loLowerCase()]?!!n.getAttribute("href"):!0}function r(n){return{input:!0,select:!0,textarea:!0,button:!0,object:!0}[n.nodeName.toLowerCase()]?!n.hasAttribute("disabled"):!0}scheduler._getFocusableNodes=function(u){for(var e,s,h=u.querySelectorAll("a[href], area[href], input, select, textarea, button, iframe, object, embed, [tabindex], [contenteditable]"),o=Array.prototype.slice.call(h,0),f=0;f<o.length;f++)e=o[f],s=(t(e)||r(e)||i(e))&&n(e),s||(o.splice(f,1),f--);return o}}();scheduler._trim=function(n){var t=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};return t.apply(n)};scheduler._isDate=function(n){return n&&"object"==typeof n?!!(n.getFullYear&&n.getMonth&&n.getDate):!1};scheduler._isObject=function(n){return n&&"object"==typeof n};window.dhtmlx||(window.dhtmlx={}),function(){function u(n,r){setTimeout(function(){if(n.box){var u=n.callback;t(!1);n.box.parentNode.removeChild(n.box);dhtmlx.callEvent("onAfterMessagePopup",[n.box]);i=n.box=null;u&&u(r)}},1)}function r(n){var t,r,f;if(i&&(n=n||event,t=n.which||event.keyCode,r=!1,dhtmlx.message.keyboard&&((13==t||32==t)&&(f=n.target||n.srcElement,scheduler._getClassName(f).indexOf("dhtmlx_popup_button")>-1&&f.click?f.click():(u(i,!0),r=!0)),27==t&&(u(i,!1),r=!0)),r))return n.preventDefault&&n.preventDefault(),!(n.cancelBubble=!0)}function t(n){t.cover||(t.cover=document.createElement("div"),t.cover.onkeydown=r,t.cover.className="dhx_modal_cover",document.body.appendChild(t.cover));document.body.scrollHeight;t.cover.style.display=n?"inline-block":"none"}function f(n,t,i){var r=scheduler._waiAria.messageButtonAttrString(n),u=i?i:n||"",f="dhtmlx_"+u.toLowerCase().replace(/ /g,"_")+"_button";return"<div "+r+"class='dhtmlx_popup_button "+f+"' result='"+t+"' ><div>"+n+"<\/div><\/div>"}function l(t){n.area||(n.area=document.createElement("div"),n.area.className="dhtmlx_message_area",n.area.style[n.position]="5px",document.body.appendChild(n.area));n.hide(t.id);var i=document.createElement("div");return i.innerHTML="<div>"+t.text+"<\/div>",i.className="dhtmlx-info dhtmlx-"+t.type,i.onclick=function(){n.hide(t.id);t=null},scheduler._waiAria.messageInfoAttr(i),"bottom"==n.position&&n.area.firstChild?n.area.insertBefore(i,n.area.firstChild):n.area.appendChild(i),t.expire>0&&(n.timers[t.id]=window.setTimeout(function(){n.hide(t.id)},t.expire)),n.pull[t.id]=i,i=null,t.id}function a(n,t,r){var e=document.createElement("div"),c,o,v,l,a,h,s;if(e.className=" dhtmlx_modal_box dhtmlx-"+n.type,e.setAttribute("dhxbox",1),c=scheduler.uid(),scheduler._waiAria.messageModalAttr(e,c),o="",v=!1,(n.width&&(e.style.width=n.width),n.height&&(e.style.height=n.height),n.title&&(o+='<div class="dhtmlx_popup_title" id="'+c+'">'+n.title+"<\/div>",v=!0),o+='<div class="dhtmlx_popup_text" '+(v?"":' id="'+c+'" ')+"><span>"+(n.content?"":n.text)+'<\/span><\/div><div  class="dhtmlx_popup_controls">',t)&&(l=n.ok||scheduler.locale.labels.message_ok,void 0===l&&(l="OK"),o+=f(l,!0,"ok")),r&&(a=n.cancel||scheduler.locale.labels.message_cancel,void 0===a&&(a="Cancel"),o+=f(a,!1,"cancel")),n.buttons)for(h=0;h<n.buttons.length;h++)o+=f(n.buttons[h],h);return(o+="<\/div>",e.innerHTML=o,n.content)&&(s=n.content,"string"==typeof s&&(s=document.getElementById(s)),"none"==s.style.display&&(s.style.display=""),e.childNodes[n.title?1:0].appendChild(s)),e.onclick=function(t){var i,f,r;t=t||event;i=t.target||t.srcElement;f=scheduler._getClassName(i);(f||(i=i.parentNode),f=scheduler._getClassName(i),"dhtmlx_popup_button"==f.split(" ")[0])&&(r=i.getAttribute("result"),r="true"==r||("false"==r?!1:r),u(n,r))},n.box=e,i=n,e}function e(n,i,u){var f=n.tagName?n:a(n,i,u),e,o;return n.hidden||t(!0),document.body.appendChild(f),e=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-f.offsetWidth)/2)),o=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-f.offsetHeight)/2)),f.style.top="top"==n.position?"-3px":o+"px",f.style.left=e+"px",f.onkeydown=r,dhtmlx.modalbox.focus(f),n.hidden&&dhtmlx.modalbox.hide(f),dhtmlx.callEvent("onMessagePopup",[f]),f}function s(n){return e(n,!0,!1)}function h(n){return e(n,!0,!0)}function c(n){return e(n)}function o(n,t,i){return"object"!=typeof n&&("function"==typeof t&&(i=t,t=""),n={text:n,type:t,callback:i}),n}function v(t,i,r,u){return"object"!=typeof t&&(t={text:t,type:i,expire:r,id:u}),t.id=t.id||n.uid(),t.expire=t.expire||n.expire,t}var i=null,n;document.attachEvent?document.attachEvent("onkeydown",r):document.addEventListener("keydown",r,!0);dhtmlx.alert=function(){var n=o.apply(this,arguments);return n.type=n.type||"confirm",s(n)};dhtmlx.confirm=function(){var n=o.apply(this,arguments);return n.type=n.type||"alert",h(n)};dhtmlx.modalbox=function(){var n=o.apply(this,arguments);return n.type=n.type||"alert",c(n)};dhtmlx.modalbox.hide=function(n){for(;n&&n.getAttribute&&!n.getAttribute("dhxbox");)n=n.parentNode;n&&(n.parentNode.removeChild(n),t(!1))};dhtmlx.modalbox.focus=function(n){setTimeout(function(){var t=scheduler._getFocusableNodes(n);t.length&&t[0].focus&&t[0].focus()},1)};n=dhtmlx.message=function(n){n=v.apply(this,arguments);n.type=n.type||"info";var t=n.type.split("-")[0];switch(t){case"alert":return s(n);case"confirm":return h(n);case"modalbox":return c(n);default:return l(n)}};n.seed=(new Date).valueOf();n.uid=function(){return n.seed++};n.expire=4e3;n.keyboard=!0;n.position="top";n.pull={};n.timers={};n.hideAll=function(){for(var t in n.pull)n.hide(t)};n.hide=function(t){var i=n.pull[t];i&&i.parentNode&&(window.setTimeout(function(){i.parentNode.removeChild(i);i=null},2e3),i.className+=" hidden",n.timers[t]&&window.clearTimeout(n.timers[t]),delete n.pull[t])}}();dhtmlx.attachEvent||dhtmlxEventable(dhtmlx);var dataProcessor=window.dataProcessor=function(n){return this.serverProcessor=n,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhtmlxEventable(this),this};dataProcessor.prototype={setTransactionMode:function(n,t){"object"==typeof n?(this._tMode=n.mode||this._tMode,void 0!==n.headers&&(this._headers=n.headers),void 0!==n.payload&&(this._payload=n.payload)):(this._tMode=n,this._tSend=t);"REST"==this._tMode&&(this._tSend=!1,this._endnm=!0);"JSON"==this._tMode&&(this._tSend=!1,this._endnm=!0,this._headers=this._headers||{},this._headers["Content-type"]="application/json")},escape:function(n){return this._utf?encodeURIComponent(n):escape(n)},enableUTFencoding:function(n){this._utf=!!n},setDataColumns:function(n){this._columns="string"==typeof n?n.split(","):n},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(n){this._endnm=!!n},enablePartialDataSend:function(n){this._changed=!!n},setUpdateMode:function(n,t){this.autoUpdate="cell"==n;this.updateMode=n;this.dnd=t},ignore:function(n,t){this._silent_mode=!0;n.call(t||window);this._silent_mode=!1},setUpdated:function(n,t,i){var r,u;this._silent_mode||(r=this.findRow(n),i=i||"updated",u=this.obj.getUserData(n,this.action_param),u&&"updated"==i&&(i=u),t?(this.set_invalid(n,!1),this.updatedRows[r]=n,this.obj.setUserData(n,this.action_param,i),this._in_progress[n]&&(this._in_progress[n]="wait")):this.is_invalid(n)||(this.updatedRows.splice(r,1),this.obj.setUserData(n,this.action_param,"")),t||this._clearUpdateFlag(n),this.markRow(n,t,i),t&&this.autoUpdate&&this.sendData(n))},_clearUpdateFlag:function(){},markRow:function(n,t,i){var u="",r=this.is_invalid(n),f;if(r&&(u=this.styles[r],t=!0),this.callEvent("onRowMark",[n,t,i,r])&&(u=this.styles[t?i:"clear"]+u,this.obj[this._methods[0]](n,u),r&&r.details))for(u+=this.styles[r+"_cell"],f=0;f<r.details.length;f++)r.details[f]&&this.obj[this._methods[1]](n,f,u)},getState:function(n){return this.obj.getUserData(n,this.action_param)},is_invalid:function(n){return this._invalid[n]},set_invalid:function(n,t,i){i&&(t={value:t,details:i,toString:function(){return this.value.toString()}});this._invalid[n]=t},checkBeforeUpdate:function(){return!0},sendData:function(n){if(!this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2)return(this.obj.editStop&&this.obj.editStop(),"undefined"==typeof n||this._tSend?this.sendAllData():this._in_progress[n]?!1:(this.messages=[],!this.checkBeforeUpdate(n)&&this.callEvent("onValidationError",[n,this.messages])?!1:void this._beforeSendData(this._getRowData(n),n)))},_beforeSendData:function(n,t){return this.callEvent("onBeforeUpdate",[t,this.getState(t),n])?void this._sendData(n,t):!1},serialize:function(n,t){var i,u,r;if("string"==typeof n)return n;if("undefined"!=typeof t)return this.serialize_one(n,"");i=[];u=[];for(r in n)n.hasOwnProperty(r)&&(i.push(this.serialize_one(n[r],r+this.post_delim)),u.push(r));return i.push("ids="+this.escape(u.join(","))),dhtmlx.security_key&&i.push("dhx_security="+dhtmlx.security_key),i.join("&")},serialize_one:function(n,t){var r,i;if("string"==typeof n)return n;r=[];for(i in n)if(n.hasOwnProperty(i)){if(("id"==i||i==this.action_param)&&"REST"==this._tMode)continue;r.push(this.escape((t||"")+i)+"="+this.escape(n[i]))}return r.join("&")},_applyPayload:function(n){var i=this.obj.$ajax,t;if(this._payload)for(t in this._payload)n=n+i.urlSeparator(n)+this.escape(t)+"="+this.escape(this._payload[t]);return n},_sendData:function(n,t){var l,i,o;if(n){if(!this.callEvent("onBeforeDataSending",t?[t,this.getState(t),n]:[null,null,n]))return!1;t&&(this._in_progress[t]=(new Date).valueOf());var h=this,f=function(i){var r=[],u;if(t)r.push(t);else if(n)for(u in n)r.push(u);return h.afterUpdate(h,i,r)},u=this.obj.$ajax,c=this.serverProcessor+(this._user?u.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):""),e=this._applyPayload(c);if("GET"==this._tMode)u.query({url:e+u.urlSeparator(e)+this.serialize(n,t),method:"GET",callback:f,headers:this._headers});else if("POST"==this._tMode)u.query({url:e,method:"POST",headers:this._headers,data:this.serialize(n,t),callback:f});else if("JSON"==this._tMode){l=n[this.action_param];i={};for(o in n)i[o]=n[o];delete i[this.action_param];delete i.id;delete i.gr_id;u.query({url:e,method:"POST",headers:this._headers,callback:f,data:JSON.stringify({id:t,action:l,data:i})})}else if("REST"==this._tMode){var a=this.getState(t),r=c.replace(/(\&|\?)editing\=true/,""),i="",s="post";"inserted"==a?i=this.serialize(n,t):"deleted"==a?(s="DELETE",r=r+("/"==r.slice(-1)?"":"/")+t):(s="PUT",i=this.serialize(n,t),r=r+("/"==r.slice(-1)?"":"/")+t);r=this._applyPayload(r);u.query({url:r,method:s,headers:this._headers,data:i,callback:f})}this._waitMode++}},sendAllData:function(){var t,n;if(this.updatedRows.length){for(this.messages=[],t=!0,n=0;n<this.updatedRows.length;n++)t&=this.checkBeforeUpdate(this.updatedRows[n]);if(!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(n=0;n<this.updatedRows.length;n++)if(!this._in_progress[this.updatedRows[n]]){if(this.is_invalid(this.updatedRows[n]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[n]),this.updatedRows[n]),this._waitMode&&("tree"==this.obj.mytype||this.obj._h2))return}}},_getAllData:function(){for(var n,i,r={},u=!1,t=0;t<this.updatedRows.length;t++)n=this.updatedRows[t],this._in_progress[n]||this.is_invalid(n)||(i=this._getRowData(n),this.callEvent("onBeforeUpdate",[n,this.getState(n),i])&&(r[n]=i,u=!0,this._in_progress[n]=(new Date).valueOf()));return u?r:null},setVerificator:function(n,t){this.mandatoryFields[n]=t||function(n){return""!==n}},clearVerificator:function(n){this.mandatoryFields[n]=!1},findRow:function(n){for(var t=0,t=0;t<this.updatedRows.length&&n!=this.updatedRows[t];t++);return t},defineAction:function(n,t){this._uActions||(this._uActions=[]);this._uActions[n]=t},afterUpdateCallback:function(n,t,i,r){var u=n,f="error"!=i&&"invalid"!=i,e;if(f||this.set_invalid(n,i),this._uActions&&this._uActions[i]&&!this._uActions[i](r))return delete this._in_progress[u];"wait"!=this._in_progress[u]&&this.setUpdated(n,!1);e=n;switch(i){case"inserted":case"insert":t!=n&&(this.setUpdated(n,!1),this.obj[this._methods[2]](n,t),n=t);break;case"delete":case"deleted":return this.obj.setUserData(n,this.action_param,"true_deleted"),this.obj[this._methods[3]](n),delete this._in_progress[u],this.callEvent("onAfterUpdate",[n,i,t,r])}"wait"!=this._in_progress[u]?(f&&this.obj.setUserData(n,this.action_param,""),delete this._in_progress[u]):(delete this._in_progress[u],this.setUpdated(t,!0,this.obj.getUserData(n,this.action_param)));this.callEvent("onAfterUpdate",[e,i,t,r])},afterUpdate:function(n,t,i){var s=this.obj.$ajax,r,o,u,f;if(window.JSON){try{r=JSON.parse(t.xmlDoc.responseText)}catch(a){t.xmlDoc.responseText.length||(r={})}if(r){var h=r.action||this.getState(i)||"updated",c=r.sid||i[0],l=r.tid||i[0];return n.afterUpdateCallback(c,l,h,r),void n.finalizeUpdate()}}if((o=s.xmltop("data",t.xmlDoc),!o)||(u=s.xpath("//data/action",o),!u.length))return this.cleanUpdate(i);for(f=0;f<u.length;f++){var e=u[f],h=e.getAttribute("type"),c=e.getAttribute("sid"),l=e.getAttribute("tid");n.afterUpdateCallback(c,l,h,e)}n.finalizeUpdate()},cleanUpdate:function(n){if(n)for(var t=0;t<n.length;t++)delete this._in_progress[n[t]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--;("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData();this.callEvent("onAfterUpdateFinish",[]);this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(n){this.obj=n;this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(n){this.attachEvent("onAfterUpdate",n)},enableDebug:function(){},setOnBeforeUpdateHandler:function(n){this.attachEvent("onBeforeDataSending",n)},setAutoUpdate:function(n,t){n=n||2e3;this._user=t||(new Date).valueOf();this._need_update=!1;this._update_busy=!1;this.attachEvent("onAfterUpdate",function(n,t,i,r){this.afterAutoUpdate(n,t,i,r)});this.attachEvent("onFullSync",function(){this.fullSync()});var i=this;window.setInterval(function(){i.loadUpdate()},n)},afterAutoUpdate:function(n,t){return"collision"==t?(this._need_update=!0,!1):!0},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(n,t){var i=this.obj.$ajax;return this._update_busy?!1:(this._update_busy=!0,void i.get(n,t))},_v:function(n){return n.firstChild?n.firstChild.nodeValue:""},_a:function(n){for(var i=[],t=0;t<n.length;t++)i[t]=this._v(n[t]);return i},loadUpdate:function(){var t=this.obj.$ajax,n=this,r=this.obj.getUserData(0,"version"),i=this.serverProcessor+t.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+r].join("&");i=i.replace("editing=true&","");this.getUpdates(i,function(i){var o=t.xpath("//userdata",i),r,u;if(n.obj.setUserData(0,"version",n._v(o[0])),r=t.xpath("//update",i),r.length){for(n._silent_mode=!0,u=0;u<r.length;u++){var s=r[u].getAttribute("status"),f=r[u].getAttribute("id"),e=r[u].getAttribute("parent");switch(s){case"inserted":n.callEvent("insertCallback",[r[u],f,e]);break;case"updated":n.callEvent("updateCallback",[r[u],f,e]);break;case"deleted":n.callEvent("deleteCallback",[r[u],f,e])}}n._silent_mode=!1}n._update_busy=!1;n=null})}};window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(n){this.init_original(n);n._dataprocessor=this;this.setTransactionMode("POST",!0);this.serverProcessor+=(-1!=this.serverProcessor.indexOf("?")?"&":"?")+"editing=true"});dhtmlxError.catchError("LoadXML",function(n,t,i){var r=i[0].responseText;switch(scheduler.config.ajax_error){case"alert":window.alert(r);break;case"console":window.console.log(r)}}),function(){function n(n){return(n+"").replace(u," ").replace(f," ")}function i(n){return(n+"").replace(e,"&#39;")}function r(){return!scheduler.config.wai_aria_attributes}var u=new RegExp("<(?:.|\n)*?>","gm"),f=new RegExp(" +","gm"),e=new RegExp("'","gm"),t;scheduler._waiAria={getAttributeString:function(t){var u=[" "],r,f;for(r in t)"function"!=typeof t[r]&&"object"!=typeof t[r]&&(f=i(n(t[r])),u.push(r+"='"+f+"'"));return u.push(" "),u.join(" ")},setAttributes:function(t,i){for(var r in i)t.setAttribute(r,n(i[r]));return t},labelAttr:function(n,t){return this.setAttributes(n,{"aria-label":t})},label:function(n){return scheduler._waiAria.getAttributeString({"aria-label":n})},hourScaleAttr:function(n,t){this.labelAttr(n,t)},monthCellAttr:function(n,t){this.labelAttr(n,scheduler.templates.day_date(t))},navBarDateAttr:function(n,t){this.labelAttr(n,t)},dayHeaderAttr:function(n,t){this.labelAttr(n,t)},dayColumnAttr:function(n,t){this.dayHeaderAttr(n,scheduler.templates.day_date(t))},headerButtonsAttributes:function(n,t){return this.setAttributes(n,{role:"button","aria-label":t})},headerToggleState:function(n,t){return this.setAttributes(n,{"aria-pressed":t?"true":"false"})},getHeaderCellAttr:function(n){return scheduler._waiAria.getAttributeString({"aria-label":n})},eventAttr:function(n,t){this._eventCommonAttr(n,t)},_eventCommonAttr:function(t,i){i.setAttribute("aria-label",n(scheduler.templates.tooltip_text(t.start_date,t.end_date,t)));scheduler.config.readonly&&i.setAttribute("aria-readonly",!0);t.$dataprocessor_class&&i.setAttribute("aria-busy",!0);i.setAttribute("aria-selected",scheduler.getState().select_id==t.id?"true":"false")},setEventBarAttr:function(n,t){this._eventCommonAttr(n,t)},_getAttributes:function(n,t){var i={setAttribute:function(n,t){this[n]=t}};return n.apply(this,[t,i]),i},eventBarAttrString:function(n){return this.getAttributeString(this._getAttributes(this.setEventBarAttr,n))},agendaHeadAttrString:function(){return this.getAttributeString({role:"row"})},agendaHeadDateString:function(n){return this.getAttributeString({role:"columnheader","aria-label":n})},agendaHeadDescriptionString:function(n){return this.agendaHeadDateString(n)},agendaDataAttrString:function(){return this.getAttributeString({role:"grid"})},agendaEventAttrString:function(n){var t=this._getAttributes(this._eventCommonAttr,n);return t.role="row",this.getAttributeString(t)},agendaDetailsBtnString:function(){return this.getAttributeString({role:"button","aria-label":scheduler.locale.labels.icon_details})},gridAttrString:function(){return this.getAttributeString({role:"grid"})},gridRowAttrString:function(n){return this.agendaEventAttrString(n)},gridCellAttrString:function(n,t,i){return this.getAttributeString({role:"gridcell","aria-label":[void 0===t.label?t.id:t.label,": ",i]})},mapAttrString:function(){return this.gridAttrString()},mapRowAttrString:function(n){return this.gridRowAttrString(n)},mapDetailsBtnString:function(){return this.agendaDetailsBtnString()},minicalHeader:function(n,t){this.setAttributes(n,{id:t+"","aria-live":"assertice","aria-atomic":"true"})},minicalGrid:function(n,t){this.setAttributes(n,{"aria-labelledby":t+"",role:"grid"})},minicalRow:function(n){this.setAttributes(n,{role:"row"})},minicalDayCell:function(n,t){var i=t.valueOf()<scheduler._max_date.valueOf()&&t.valueOf()>=scheduler._min_date.valueOf();this.setAttributes(n,{role:"gridcell","aria-label":scheduler.templates.day_date(t),"aria-selected":i?"true":"false"})},minicalHeadCell:function(n){this.setAttributes(n,{role:"columnheader"})},weekAgendaDayCell:function(n){var i=n.querySelector(".dhx_wa_scale_bar"),r=n.querySelector(".dhx_wa_day_data"),t=scheduler.uid()+"";this.setAttributes(i,{id:t});this.setAttributes(r,{"aria-labelledby":t})},weekAgendaEvent:function(n,t){this.eventAttr(t,n)},lightboxHiddenAttr:function(n){n.setAttribute("aria-hidden","true")},lightboxVisibleAttr:function(n){n.setAttribute("aria-hidden","false")},lightboxSectionButtonAttrString:function(n){return this.getAttributeString({role:"button","aria-label":n,tabindex:"0"})},yearHeader:function(n,t){this.setAttributes(n,{id:t+""})},yearGrid:function(n,t){this.minicalGrid(n,t)},yearHeadCell:function(n){return this.minicalHeadCell(n)},yearRow:function(n){return this.minicalRow(n)},yearDayCell:function(n){this.setAttributes(n,{role:"gridcell"})},lightboxAttr:function(n){n.setAttribute("role","dialog");n.setAttribute("aria-hidden","true");n.firstChild.setAttribute("role","heading")},lightboxButtonAttrString:function(n){return this.getAttributeString({role:"button","aria-label":scheduler.locale.labels[n],tabindex:"0"})},eventMenuAttrString:function(n){return this.getAttributeString({role:"button","aria-label":scheduler.locale.labels[n]})},lightboxHeader:function(n,t){n.setAttribute("aria-label",t)},lightboxSelectAttrString:function(n){var t="";switch(n){case"%Y":t=scheduler.locale.labels.year;break;case"%m":t=scheduler.locale.labels.month;break;case"%d":t=scheduler.locale.labels.day;break;case"%H:%i":t=scheduler.locale.labels.hour+" "+scheduler.locale.labels.minute}return scheduler._waiAria.getAttributeString({"aria-label":t})},messageButtonAttrString:function(n){return"tabindex='0' role='button' aria-label='"+n+"'"},messageInfoAttr:function(n){n.setAttribute("role","alert")},messageModalAttr:function(n,t){n.setAttribute("role","dialog");t&&n.setAttribute("aria-labelledby",t)},quickInfoAttr:function(n){n.setAttribute("role","dialog")},quickInfoHeaderAttrString:function(){return" role='heading' "},quickInfoHeader:function(n,t){n.setAttribute("aria-label",t)},quickInfoButtonAttrString:function(n){return scheduler._waiAria.getAttributeString({role:"button","aria-label":n,tabindex:"0"})},tooltipAttr:function(n){n.setAttribute("role","tooltip")},tooltipVisibleAttr:function(n){n.setAttribute("aria-hidden","false")},tooltipHiddenAttr:function(n){n.setAttribute("aria-hidden","true")}};for(t in scheduler._waiAria)scheduler._waiAria[t]=function(n){return function(){return r()?" ":n.apply(this,arguments)}}(scheduler._waiAria[t])}();dhtmlxEventable(scheduler);scheduler._detachDomEvent=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)};scheduler._init_once=function(){function n(n){for(var t=document.body;n&&n!=t;)n=n.parentNode;return!(t!=n)}function t(){return{w:window.innerWidth||document.documentElement.clientWidth,h:window.innerHeight||document.documentElement.clientHeight}}function r(n,t){return n.w==t.w&&n.h==t.h}var i=t();dhtmlxEvent(window,"resize",function(){n(scheduler._obj)&&(window.clearTimeout(scheduler._resize_timer),scheduler._resize_timer=window.setTimeout(function(){var u=t();if(!r(i,u)){if(!n(scheduler._obj))return;scheduler.callEvent("onSchedulerResize",[])&&(scheduler.update_view(),scheduler.callEvent("onAfterSchedulerResize",[]))}i=u},20))});scheduler._init_once=function(){}};scheduler.init=function(n,t,i){t=t||scheduler._currentDate();i=i||"week";this._obj&&this.unset_actions();this._obj="string"==typeof n?document.getElementById(n):n;this.$container=this._obj;this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&this.$container.setAttribute("role","application");this._skin_init&&scheduler._skin_init();scheduler.date.init();this._els=[];this._scroll=!0;this._quirks=_isIE&&"BackCompat"==document.compatMode;this._quirks7=_isIE&&-1==navigator.appVersion.indexOf("MSIE 8");this.get_elements();this.init_templates();this.set_actions();this._init_once();this._init_touch_events();this.set_sizes();scheduler.callEvent("onSchedulerReady",[]);this.setCurrentView(t,i)};scheduler.xy={min_event_height:40,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22,event_header_height:14};scheduler.keys={edit_save:13,edit_cancel:27};scheduler.set_sizes=function(){var t=this._x=this._obj.clientWidth-this.xy.margin_left,u=this._y=this._obj.clientHeight-this.xy.margin_top,f=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,e=this._table_view?-1:this.xy.scale_width,n=this.$container.querySelector(".dhx_cal_scale_placeholder"),i,r;scheduler._is_material_skin()?(n||(n=document.createElement("div"),n.className="dhx_cal_scale_placeholder",this.$container.insertBefore(n,this._els.dhx_cal_header[0])),n.style.display="block",this.set_xy(n,t,this.xy.scale_height+1,0,this.xy.nav_height+(this._quirks?-1:1))):n&&n.parentNode.removeChild(n);this.set_xy(this._els.dhx_cal_navline[0],t,this.xy.nav_height,0,0);this.set_xy(this._els.dhx_cal_header[0],t-f,this.xy.scale_height,e,this.xy.nav_height+(this._quirks?-1:1));i=this._els.dhx_cal_navline[0].offsetHeight;i>0&&(this.xy.nav_height=i);r=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);this.set_xy(this._els.dhx_cal_data[0],t,u-(r+2),0,r+2)};scheduler.set_xy=function(n,t,i,r,u){n.style.width=Math.max(0,t)+"px";n.style.height=Math.max(0,i)+"px";arguments.length>3&&(n.style.left=r+"px",n.style.top=u+"px")};scheduler.get_elements=function(){for(var i,u,r,t=this._obj.getElementsByTagName("DIV"),n=0;n<t.length;n++)i=scheduler._getClassName(t[n]),u=t[n].getAttribute("name")||"",i&&(i=i.split(" ")[0]),this._els[i]||(this._els[i]=[]),this._els[i].push(t[n]),r=scheduler.locale.labels[u||i],"string"!=typeof r&&u&&!t[n].innerHTML&&(r=u.split("_")[0]),r&&(this._waiAria.labelAttr(t[n],r),t[n].innerHTML=r)};scheduler.unset_actions=function(){var n,t;for(n in this._els)if(this._click[n])for(t=0;t<this._els[n].length;t++)this._els[n][t].onclick=null;this._obj.onselectstart=null;this._obj.onmousemove=null;this._obj.onmousedown=null;this._obj.onmouseup=null;this._obj.ondblclick=null;this._obj.oncontextmenu=null};scheduler.set_actions=function(){var n,t;for(n in this._els)if(this._click[n])for(t=0;t<this._els[n].length;t++)this._els[n][t].onclick=scheduler._click[n];this._obj.onselectstart=function(){return!1};this._obj.onmousemove=function(n){scheduler._temp_touch_block||scheduler._on_mouse_move(n||event)};this._obj.onmousedown=function(n){scheduler._ignore_next_click||scheduler._on_mouse_down(n||event)};this._obj.onmouseup=function(n){scheduler._ignore_next_click||scheduler._on_mouse_up(n||event)};this._obj.ondblclick=function(n){scheduler._on_dbl_click(n||event)};this._obj.oncontextmenu=function(n){var t=n||event,i=t.target||t.srcElement;return scheduler.callEvent("onContextMenu",[scheduler._locate_event(i),t])}};scheduler.select=function(n){this._select_id!=n&&(scheduler._close_not_saved(),this.editStop(!1),this.unselect(),this._select_id=n,this.updateEvent(n))};scheduler.unselect=function(n){if(!n||n==this._select_id){var t=this._select_id;this._select_id=null;t&&this.getEvent(t)&&this.updateEvent(t)}};scheduler.getState=function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}};scheduler._click={dhx_cal_data:function(n){var i,t,r;if(scheduler._ignore_next_click)return n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,scheduler._ignore_next_click=!1,!1;if(i=n?n.target:event.srcElement,t=scheduler._locate_event(i),n=n||event,t){if(!scheduler.callEvent("onClick",[t,n])||scheduler.config.readonly)return}else scheduler.callEvent("onEmptyClick",[scheduler.getActionData(n).date,n]);t&&scheduler.config.select?(scheduler.select(t),r=scheduler._getClassName(i),-1!=r.indexOf("_icon")&&scheduler._click.buttons[r.split(" ")[1].replace("icon_","")](t)):(scheduler._close_not_saved(),(new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler.unselect())},dhx_cal_prev_button:function(){scheduler._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(n,t){scheduler.setCurrentView(scheduler.date.add(scheduler.date[scheduler._mode+"_start"](scheduler._date),t||1,scheduler._mode))},dhx_cal_today_button:function(){scheduler.callEvent("onBeforeTodayDisplayed",[])&&scheduler.setCurrentView(scheduler._currentDate())},dhx_cal_tab:function(){var n=this.getAttribute("name"),t=n.substring(0,n.search("_tab"));scheduler.setCurrentView(scheduler._date,t)},buttons:{"delete":function(n){var t=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(t,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(n)})},edit:function(n){scheduler.edit(n)},save:function(){scheduler.editStop(!0)},details:function(n){scheduler.showLightbox(n)},cancel:function(){scheduler.editStop(!1)}}};scheduler._dhtmlx_confirm=function(n,t,i){if(!n)return i();var r={text:n};t&&(r.title=t);i&&(r.callback=function(n){n&&i()});dhtmlx.confirm(r)};scheduler.addEventNow=function(n,t,i){var r={},f,u,o,e,s;return scheduler._isObject(n)&&!scheduler._isDate(n)&&(r=n,n=null),f=6e4*(this.config.event_duration||this.config.time_step),n||(n=r.start_date||Math.round(scheduler._currentDate().valueOf()/f)*f),u=new Date(n),t||(o=this.config.first_hour,o>u.getHours()&&(u.setHours(o),n=u.valueOf()),t=n.valueOf()+f),e=new Date(t),u.valueOf()==e.valueOf()&&e.setTime(e.valueOf()+f),r.start_date=r.start_date||u,r.end_date=r.end_date||e,r.text=r.text||this.locale.labels.new_event,r.id=this._drag_id=r.id||this.uid(),this._drag_mode="new-size",this._loading=!0,s=this.addEvent(r),this.callEvent("onEventCreated",[this._drag_id,i]),this._loading=!1,this._drag_event={},this._on_mouse_up(i),s};scheduler._on_dbl_click=function(n,t){var r,i,u;if(t=t||n.target||n.srcElement,!this.config.readonly){r=scheduler._getClassName(t).split(" ")[0];switch(r){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!scheduler.config.dblclick_create)break;this.addEventNow(this.getActionData(n).date,null,n);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":if(i=this._locate_event(t),!this.callEvent("onDblClick",[i,n]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(i)._timed||!this.config.select?this.showLightbox(i):this.edit(i);break;case"dhx_time_block":case"dhx_cal_container":return;default:if(u=this["dblclick_"+r],u)u.call(this,n);else if(t.parentNode&&t!=this)return scheduler._on_dbl_click(n,t.parentNode)}}};scheduler._get_column_index=function(n){var i=0,r,t;if(this._cols){for(r=0,t=0;r+this._cols[t]<n&&t<this._cols.length;)r+=this._cols[t],t++;if(i=t+(this._cols[t]?(n-r)/this._cols[t]:0),this._ignores&&i>=this._cols.length)for(;i>=1&&this._ignores[Math.floor(i)];)i--}return i};scheduler._week_indexes_from_pos=function(n){if(this._cols){var t=this._get_column_index(n.x);return n.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(t)-1)),n.y=Math.max(0,Math.ceil(60*n.y/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),n}return n};scheduler._mouse_coords=function(n){var t,r=document.body,e=document.documentElement,u,f,i;if(t=_isIE||!n.pageX&&!n.pageY?{x:n.clientX+(r.scrollLeft||e.scrollLeft||0)-r.clientLeft,y:n.clientY+(r.scrollTop||e.scrollTop||0)-r.clientTop}:{x:n.pageX,y:n.pageY},t.x-=this.$domHelpers.getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width),t.y-=this.$domHelpers.getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els.dhx_cal_data[0].scrollTop,t.ev=n,u=this["mouse_"+this._mode],u)t=u.call(this,t);else if(this._table_view){if(f=this._get_column_index(t.x),!this._cols||!this._colsS)return t;for(i=0,i=1;i<this._colsS.heights.length&&!(this._colsS.heights[i]>t.y);i++);t.y=Math.ceil(1440*(Math.max(0,f)+7*Math.max(0,i-1))/this.config.time_step);(scheduler._drag_mode||"month"==this._mode)&&(t.y=1440*(Math.max(0,Math.ceil(f)-1)+7*Math.max(0,i-1))/this.config.time_step);"move"==this._drag_mode&&scheduler._ignores_detected&&scheduler.config.preserve_length&&(t._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"})));t.x=0}else t=this._week_indexes_from_pos(t);return t.timestamp=+new Date,t};scheduler._close_not_saved=function(){if((new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler._edit_id){var n=scheduler.locale.labels.confirm_closing;scheduler._dhtmlx_confirm(n,scheduler.locale.labels.title_confirm_closing,function(){scheduler.editStop(scheduler.config.positive_closing)});n&&(this._drag_id=this._drag_pos=this._drag_mode=null)}};scheduler._correct_shift=function(n,t){return n-6e4*(new Date(scheduler._min_date).getTimezoneOffset()-new Date(n).getTimezoneOffset())*(t?-1:1)};scheduler._is_pos_changed=function(n,t){function i(n,t,i){return!!(Math.abs(n-t)>i)}if(!n||!this._drag_pos)return!0;var r=5;return!!(this._drag_pos.has_moved||!this._drag_pos.timestamp||t.timestamp-this._drag_pos.timestamp>100||i(n.ev.clientX,t.ev.clientX,r)||i(n.ev.clientY,t.ev.clientY,r))};scheduler._correct_drag_start_date=function(n){var t,i;return scheduler.matrix&&(t=scheduler.matrix[scheduler._mode]),t=t||{x_step:1,x_unit:"day"},n=new Date(n),i=1,(t._start_correction||t._end_correction)&&(i=60*(t.last_hour||0)-(60*n.getHours()+n.getMinutes())||1),1*n+(scheduler._get_fictional_event_length(n,i,t)-i)};scheduler._correct_drag_end_date=function(n,t){var i,r;return scheduler.matrix&&(i=scheduler.matrix[scheduler._mode]),i=i||{x_step:1,x_unit:"day"},r=1*n+scheduler._get_fictional_event_length(n,t,i),new Date(1*r-(scheduler._get_fictional_event_length(r,-1,i,-1)+1))};scheduler._on_mouse_move=function(n){var i,u,t,s,w,v,h,f,e,o,y,b,p,r,l,a,c,k,d;if(this._drag_mode){if(i=this._mouse_coords(n),this._is_pos_changed(this._drag_pos,i)){if(this._edit_id!=this._drag_id&&this._close_not_saved(),!this._drag_mode)return;if(s=null,this._drag_pos&&!this._drag_pos.has_moved&&(s=this._drag_pos,s.has_moved=!0),this._drag_pos=i,this._drag_pos.has_moved=!0,"create"==this._drag_mode){if(s&&(i=s),this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,u=this._get_date_from_pos(i).valueOf(),!this._drag_start)return w=this.callEvent("onBeforeEventCreated",[n,this._drag_id]),w?(this._loading=!1,void(this._drag_start=u)):void(this._loading=!1);t=u;t==this._drag_start;v=new Date(this._drag_start);h=new Date(t);"day"!=this._mode&&"week"!=this._mode||v.getHours()!=h.getHours()||v.getMinutes()!=h.getMinutes()||(h=new Date(this._drag_start+1e3));this._drag_id=this.uid();this.addEvent(v,h,this.locale.labels.new_event,this._drag_id,i.fields);this.callEvent("onEventCreated",[this._drag_id,n]);this._loading=!1;this._drag_mode="new-size"}e=this.getEvent(this._drag_id);(scheduler.matrix&&(f=scheduler.matrix[scheduler._mode]),f=f||{x_step:1,x_unit:"day"},"move"==this._drag_mode)?(u=this._min_date.valueOf()+6e4*(i.y*this.config.time_step+1440*i.x-(scheduler._move_pos_shift||0)),!i.custom&&this._table_view&&(u+=1e3*this.date.time_part(e.start_date)),u=this._correct_shift(u),i._ignores&&this.config.preserve_length&&this._table_view?(u=scheduler._correct_drag_start_date(u),t=scheduler._correct_drag_end_date(u,this._drag_event._event_length)):t=e.end_date.valueOf()-(e.start_date.valueOf()-u)):((u=e.start_date.valueOf(),t=e.end_date.valueOf(),this._table_view)?(o=this._min_date.valueOf()+i.y*this.config.time_step*6e4+(i.custom?0:864e5),"month"==this._mode?(o=this._correct_shift(o,!1),this._drag_from_start)?(c=864e5,o<=scheduler.date.date_part(new Date(t+c-1)).valueOf()&&(u=o-c)):t=o:this.config.preserve_length?i.resize_from_start?u=scheduler._correct_drag_start_date(o):t=scheduler._correct_drag_end_date(o,0):i.resize_from_start?u=o:t=o):(y=this.date.date_part(new Date(e.end_date.valueOf()-1)).valueOf(),b=new Date(y),t=y+i.y*this.config.time_step*6e4,t+=6e4*(new Date(t).getTimezoneOffset()-b.getTimezoneOffset()),this._els.dhx_cal_data[0].style.cursor="s-resize",("week"==this._mode||"day"==this._mode)&&(t=this._correct_shift(t))),"new-size"==this._drag_mode?t<=this._drag_start?(p=i.shift||(this._table_view&&!i.custom?864e5:0),u=t-(i.shift?0:p),t=this._drag_start+(p||6e4*this.config.time_step)):u=this._drag_start:u>=t&&(t=u+6e4*this.config.time_step));l=new Date(t-1);r=new Date(u);"move"==this._drag_mode&&scheduler.config.limit_drag_out&&(+r<+scheduler._min_date||+t>+scheduler._max_date)&&(+e.start_date<+scheduler._min_date||+e.end_date>+scheduler._max_date?(r=new Date(e.start_date),t=new Date(e.end_date)):(a=t-r,+r<+scheduler._min_date?(r=new Date(scheduler._min_date),i._ignores&&this.config.preserve_length&&this._table_view?(r=new Date(scheduler._correct_drag_start_date(r)),f._start_correction&&(r=new Date(r.valueOf()+f._start_correction)),t=new Date(1*r+this._get_fictional_event_length(r,this._drag_event._event_length,f))):t=new Date(+r+a)):(t=new Date(scheduler._max_date),i._ignores&&this.config.preserve_length&&this._table_view?(f._end_correction&&(t=new Date(t.valueOf()-f._end_correction)),t=new Date(1*t-this._get_fictional_event_length(t,0,f,!0)),r=new Date(1*t-this._get_fictional_event_length(t,this._drag_event._event_length,f,!0)),this._ignores_detected&&(r=scheduler.date.add(r,f.x_step,f.x_unit),t=new Date(1*t-this._get_fictional_event_length(t,0,f,!0)),t=scheduler.date.add(t,f.x_step,f.x_unit))):r=new Date(+t-a))),l=new Date(t-1));this._table_view||scheduler.config.all_timed||!(!scheduler._get_section_view()&&i.x!=this._get_event_sday({start_date:new Date(t),end_date:new Date(t)})||new Date(t).getHours()>=this.config.last_hour)||(a=t-r,c=this._min_date.valueOf()+864e5*i.x,t=scheduler.date.date_part(new Date(c)),t.setHours(this.config.last_hour),l=new Date(t-1),"move"==this._drag_mode&&(r=new Date(+t-a)));(this._table_view||l.getDate()==r.getDate()&&l.getHours()<this.config.last_hour||scheduler._allow_dnd)&&((e.start_date=r,e.end_date=new Date(t),this.config.update_render)?(k=scheduler._els.dhx_cal_data[0].scrollTop,this.update_view(),scheduler._els.dhx_cal_data[0].scrollTop=k):this.updateEvent(this._drag_id));this._table_view&&this.for_rendered(this._drag_id,function(n){n.className+=" dhx_in_move dhx_cal_event_drag"});this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,n])}}else scheduler.checkEvent("onMouseMove")&&(d=this._locate_event(n.target||n.srcElement),this.callEvent("onMouseMove",[d,n]))};scheduler._on_mouse_down=function(n,t){var i,u,r;if(2!=n.button&&!this.config.readonly&&!this._drag_mode){t=t||n.target||n.srcElement;i=scheduler._getClassName(t).split(" ")[0];switch(i){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize";u=scheduler._getClassName(t);scheduler._drag_from_start=u.indexOf("dhx_event_resize_end")<0?!0:!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(t.parentNode)return scheduler._on_mouse_down(n,t.parentNode);break;default:if((!scheduler.checkEvent("onMouseDown")||scheduler.callEvent("onMouseDown",[i,n]))&&t.parentNode&&t!=this&&"dhx_body"!=i)return scheduler._on_mouse_down(n,t.parentNode);this._drag_mode=null;this._drag_id=null}if(this._drag_mode)if(r=this._locate_event(t),this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[r,this._drag_mode,n])){if(this._drag_id=r,(this._edit_id!=this._drag_id||this._edit_id&&"create"==this._drag_mode)&&this._close_not_saved(),!this._drag_mode)return;this._drag_event=scheduler._lame_clone(this.getEvent(this._drag_id)||{});this._drag_pos=this._mouse_coords(n)}else this._drag_mode=this._drag_id=0;this._drag_start=null}};scheduler._get_private_properties=function(n){var t={};for(var i in n)0===i.indexOf("_")&&(t[i]=!0);return t};scheduler._clear_temporary_properties=function(n,t){var r=this._get_private_properties(n),u=this._get_private_properties(t);for(var i in u)r[i]||delete t[i]};scheduler._on_mouse_up=function(n){var r;if(!n||2!=n.button||!this._mobile){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var t=this._drag_id,u=this._drag_mode,f=!this._drag_pos||this._drag_pos.has_moved,i=this.getEvent(this._drag_id);if(f&&(this._drag_event._dhx_changed||!this._drag_event.start_date||i.start_date.valueOf()!=this._drag_event.start_date.valueOf()||i.end_date.valueOf()!=this._drag_event.end_date.valueOf()))if(r="new-size"==this._drag_mode,this.callEvent("onBeforeEventChanged",[i,n,r,this._drag_event]))if(this._drag_id=this._drag_mode=null,r&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select||!this.isOneDayEvent(this.getEvent(t)))return scheduler.callEvent("onDragEnd",[t,u,n]),this.showLightbox(t);this._drag_pos=!0;this._select_id=this._edit_id=t}else this._new_event||this.callEvent(r?"onEventAdded":"onEventChanged",[t,this.getEvent(t)]);else r?this.deleteEvent(i.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(i,this._drag_event),scheduler._lame_copy(i,this._drag_event),this.updateEvent(i.id));this._drag_pos&&(this._drag_pos.has_moved||this._drag_pos===!0)&&(this._drag_id=this._drag_mode=null,this.render_view_data());scheduler.callEvent("onDragEnd",[t,u,n])}this._drag_id=null;this._drag_mode=null;this._drag_pos=null}};scheduler._trigger_dyn_loading=function(){return this._load_mode&&this._load()?(this._render_wait=!0,!0):!1};scheduler.update_view=function(){this._reset_ignores();var n=this[this._mode+"_view"];return n?n(!0):this._reset_scale(),this._trigger_dyn_loading()?!0:void this.render_view_data()};scheduler.isViewExists=function(n){return!!(scheduler[n+"_view"]||scheduler.date[n+"_start"]&&scheduler.templates[n+"_date"]&&scheduler.templates[n+"_scale_date"])};scheduler._set_aria_buttons_attrs=function(){for(var r,u,f,i,t=["dhx_cal_next_button","dhx_cal_prev_button","dhx_cal_tab","dhx_cal_today_button"],n=0;n<t.length;n++)for(r=this._els[t[n]],u=0;r&&u<r.length;u++)f=r[u].getAttribute("name"),i=this.locale.labels[t[n]],f&&(i=this.locale.labels[f]||i),"dhx_cal_next_button"==t[n]?i=this.locale.labels.next:"dhx_cal_prev_button"==t[n]&&(i=this.locale.labels.prev),this._waiAria.headerButtonsAttributes(r[u],i||"")};scheduler.updateView=function(n,t){var s,i,h,e,o,r,u;n=n||this._date;t=t||this._mode;var c="dhx_cal_data",f=this._obj,l="dhx_scheduler_"+this._mode,a="dhx_scheduler_"+t;if(this._mode&&-1!=f.className.indexOf(l)?f.className=f.className.replace(l,a):f.className+=" "+a,i="dhx_multi_day",h=this._mode==t&&this.config.preserve_scroll?this._els[c][0].scrollTop:!1,this._els[i]&&this._els[i][0]&&(s=this._els[i][0].scrollTop),this[this._mode+"_view"]&&t&&this._mode!=t&&this[this._mode+"_view"](!1),this._close_not_saved(),this._els[i]&&(this._els[i][0].parentNode.removeChild(this._els[i][0]),this._els[i]=null),this._mode=t,this._date=n,this._table_view="month"==this._mode,this._dy_shift=0,this._set_aria_buttons_attrs(),e=this._els.dhx_cal_tab,e)for(o=0;o<e.length;o++)r=e[o],u=r.className,u=u.replace(/ active/g,""),r.getAttribute("name")==this._mode+"_tab"?(u+=" active",this._waiAria.headerToggleState(r,!0)):this._waiAria.headerToggleState(r,!1),r.className=u;this.update_view();"number"==typeof h&&(this._els[c][0].scrollTop=h);"number"==typeof s&&this._els[i]&&this._els[i][0]&&(this._els[i][0].scrollTop=s)};scheduler.setCurrentView=function(n,t){this.callEvent("onBeforeViewChange",[this._mode,this._date,t||this._mode,n||this._date])&&(this.updateView(n,t),this.callEvent("onViewChange",[this._mode,this._date]))};scheduler._render_x_header=function(n,t,i,r,u){var f,o,e;u=u||0;f=document.createElement("div");f.className="dhx_scale_bar";this.templates[this._mode+"_scalex_class"]&&(f.className+=" "+this.templates[this._mode+"_scalex_class"](i));o=this._cols[n]-1;"month"==this._mode&&0===n&&this.config.left_border&&(f.className+=" dhx_scale_bar_border",t+=1);this.set_xy(f,o,this.xy.scale_height-2,t,u);e=this.templates[this._mode+"_scale_date"](i,this._mode);f.innerHTML=e;this._waiAria.dayHeaderAttr(f,e);r.appendChild(f)};scheduler._get_columns_num=function(n,t){var r=7,i;return scheduler._table_view||(i=scheduler.date["get_"+scheduler._mode+"_end"],i&&(t=i(n)),r=Math.round((t.valueOf()-n.valueOf())/864e5)),r};scheduler._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))};scheduler._get_view_end=function(){var t=this._get_timeunit_start(),i=scheduler.date.add(t,1,this._mode),n;return scheduler._table_view||(n=scheduler.date["get_"+scheduler._mode+"_end"],n&&(i=n(t))),i};scheduler._calc_scale_sizes=function(n,t,i){var e=n,u=this._get_columns_num(t,i),f,r;for(this._process_ignores(t,u,"day",1),f=u-this._ignores_detected,r=0;u>r;r++)this._ignores[r]?(this._cols[r]=0,f++):this._cols[r]=Math.floor(e/(f-r)),e-=this._cols[r],this._colsS[r]=(this._cols[r-1]||0)+(this._colsS[r-1]||(this._table_view?0:this.xy.scale_width+2));this._colsS.col_length=u;this._colsS[u]=this._cols[u-1]+this._colsS[u-1]||0};scheduler._set_scale_col_size=function(n,t,i){var r=this.config;this.set_xy(n,t-1,r.hour_size_px*(r.last_hour-r.first_hour),i+this.xy.scale_width+1,0)};scheduler._render_scales=function(n,t){var o=new Date(scheduler._min_date),s=new Date(scheduler._max_date),h=this.date.date_part(scheduler._currentDate()),c=parseInt(n.style.width,10),i=new Date(this._min_date),l=this._get_columns_num(o,s),f,r,u,e;for(this._calc_scale_sizes(c,o,s),f=0,n.innerHTML="",r=0;l>r;r++)(this._ignores[r]||this._render_x_header(r,f,i,n),this._table_view)||(u=document.createElement("div"),e="dhx_scale_holder",i.valueOf()==h.valueOf()&&(e="dhx_scale_holder_now"),this._ignores_detected&&this._ignores[r]&&(e+=" dhx_scale_ignore"),u.className=e+" "+this.templates.week_date_class(i,h),this._waiAria.dayColumnAttr(u,i),this._set_scale_col_size(u,this._cols[r],f),t.appendChild(u),this.callEvent("onScaleAdd",[u,i])),f+=this._cols[r],i=this.date.add(i,1,"day"),i=this.date.day_start(i)};scheduler._reset_scale=function(){var c,l,e,r,o,s,n,u;if(this.templates[this._mode+"_date"]){var h=this._els.dhx_cal_header[0],t=this._els.dhx_cal_data[0],f=this.config;if(h.innerHTML="",t.innerHTML="",c=(f.readonly||!f.drag_resize?" dhx_resize_denied":"")+(f.readonly||!f.drag_move?" dhx_move_denied":""),t.className="dhx_cal_data"+c,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes(),r=this._get_timeunit_start(),o=scheduler._get_view_end(),l=e=this._table_view?scheduler.date.week_start(r):r,this._min_date=l,s=this.templates[this._mode+"_date"](r,o,this._mode),this._els.dhx_cal_date[0].innerHTML=s,this._waiAria.navBarDateAttr(this._els.dhx_cal_date[0],s),this._max_date=o,scheduler._render_scales(h,t),this._table_view)this._reset_month_scale(t,r,e);else if(this._reset_hours_scale(t,r,e),f.multi_day){n="dhx_multi_day";this._els[n]&&(this._els[n][0].parentNode.removeChild(this._els[n][0]),this._els[n]=null);var v=this._els.dhx_cal_navline[0],a=v.offsetHeight+this._els.dhx_cal_header[0].offsetHeight+1,i=document.createElement("div");i.className=n;i.style.visibility="hidden";this.set_xy(i,Math.max(this._colsS[this._colsS.col_length]+this.xy.scroll_width-2,0),0,0,a);t.parentNode.insertBefore(i,t);u=i.cloneNode(!0);u.className=n+"_icon";u.style.visibility="hidden";this.set_xy(u,this.xy.scale_width,0,0,a);i.appendChild(u);this._els[n]=[i,u];this._els[n][0].onclick=this._click.dhx_cal_data}}};scheduler._reset_hours_scale=function(n){var r=document.createElement("div"),i,u,t,e,f;for(r.className="dhx_scale_holder",i=new Date(1980,1,1,this.config.first_hour,0,0),u=1*this.config.first_hour;u<this.config.last_hour;u++)t=document.createElement("div"),t.className="dhx_scale_hour",t.style.height=this.config.hour_size_px+"px",e=this.xy.scale_width,this.config.left_border&&(t.className+=" dhx_scale_hour_border"),t.style.width=e+"px",f=scheduler.templates.hour_scale(i),t.innerHTML=f,this._waiAria.hourScaleAttr(t,f),r.appendChild(t),i=this.date.add(i,1,"hour");n.appendChild(r);this.config.scroll_hour&&(n.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))};scheduler._currentDate=function(){return scheduler.config.now_date?new Date(scheduler.config.now_date):new Date};scheduler._reset_ignores=function(){this._ignores={};this._ignores_detected=0};scheduler._process_ignores=function(n,t,i,r,u){var o,f,e;if(this._reset_ignores(),o=scheduler["ignore_"+this._mode],o)for(f=new Date(n),e=0;t>e;e++)o(f)&&(this._ignores_detected+=1,this._ignores[e]=!0,u&&t++),f=scheduler.date.add(f,r,i),scheduler.date[i+"_start"]&&(f=scheduler.date[i+"_start"](f))};scheduler._render_month_scale=function(n,t,i,r){function tt(n){var t=scheduler._colsS.height;return void 0!==scheduler._colsS.heights[n+1]&&(t=scheduler._colsS.heights[n+1]-(scheduler._colsS.heights[n]||0)),t}var it=scheduler.date.add(t,1,"month"),ft=new Date(i),v=scheduler._currentDate(),y,p,w,h,b,o,k,rt,e,f,s,d,g,a,c,nt,ut,n,u,l;for(this.date.date_part(v),this.date.date_part(i),r=r||Math.ceil(Math.round((it.valueOf()-i.valueOf())/864e5)/7),y=[],u=0;7>=u;u++)p=(this._cols[u]||0)-1,0===u&&this.config.left_border&&(p-=1),y[u]=p+"px";for(w=0,h=document.createElement("table"),h.setAttribute("cellpadding","0"),h.setAttribute("cellspacing","0"),b=document.createElement("tbody"),h.appendChild(b),o=[],u=0;r>u;u++){for(k=document.createElement("tr"),b.appendChild(k),rt=Math.max(tt(u)-scheduler.xy.month_head_height,0),e=0;7>e;e++)f=document.createElement("td"),k.appendChild(f),s="",t>i?s="dhx_before":i>=it?s="dhx_after":i.valueOf()==v.valueOf()&&(s="dhx_now"),this._ignores_detected&&this._ignores[e]&&(s+=" dhx_scale_ignore"),f.className=s+" "+this.templates.month_date_class(i,v),d="dhx_month_body",g="dhx_month_head",(0===e&&this.config.left_border&&(d+=" dhx_month_body_border",g+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[e])?(f.appendChild(document.createElement("div")),f.appendChild(document.createElement("div"))):(this._waiAria.monthCellAttr(f,i),a=document.createElement("div"),a.className=g,a.innerHTML=this.templates.month_day(i),f.appendChild(a),c=document.createElement("div"),c.className=d,c.style.height=rt+"px",c.style.width=y[e],f.appendChild(c)),o.push(i),nt=i.getDate(),i=this.date.add(i,1,"day"),i.getDate()-nt>1&&(i=new Date(i.getFullYear(),i.getMonth(),nt+1,12,0));scheduler._colsS.heights[u]=w;w+=tt(u)}for(this._min_date=ft,this._max_date=i,n.innerHTML="",n.appendChild(h),this._scales={},ut=n.getElementsByTagName("div"),u=0;u<o.length;u++)n=ut[2*u+1],l=o[u],this._scales[+l]=n;for(u=0;u<o.length;u++)l=o[u],this.callEvent("onScaleAdd",[this._scales[+l],l]);return this._max_date};scheduler._reset_month_scale=function(n,t,i,r){var f=scheduler.date.add(t,1,"month"),e=scheduler._currentDate(),u;return this.date.date_part(e),this.date.date_part(i),r=r||Math.ceil(Math.round((f.valueOf()-i.valueOf())/864e5)/7),u=Math.floor(n.clientHeight/r)-this.xy.month_head_height,this._colsS.height=u+this.xy.month_head_height,this._colsS.heights=[],scheduler._render_month_scale(n,t,i,r)};scheduler.getLabel=function(n,t){for(var f,r,u=this.config.lightbox.sections,i=0;i<u.length;i++)if(u[i].map_to==n)for(f=u[i].options,r=0;r<f.length;r++)if(f[r].key==t)return f[r].label;return""};scheduler.updateCollection=function(n,t){var i=scheduler.serverList(n);return i?(i.splice(0,i.length),i.push.apply(i,t||[]),scheduler.callEvent("onOptionsLoad",[]),scheduler.resetLightbox(),!0):!1};scheduler._lame_clone=function(n,t){var i,r,u;for(t=t||[],i=0;i<t.length;i+=2)if(n===t[i])return t[i+1];if(n&&"object"==typeof n){for(u={},r=[Array,Date,Number,String,Boolean],i=0;i<r.length;i++)n instanceof r[i]&&(u=i?new r[i](n):new r[i]);t.push(n,u);for(i in n)Object.prototype.hasOwnProperty.apply(n,[i])&&(u[i]=scheduler._lame_clone(n[i],t))}return u||n};scheduler._lame_copy=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n};scheduler._get_date_from_pos=function(n){var t=this._min_date.valueOf()+6e4*(n.y*this.config.time_step+1440*(this._table_view?0:n.x));return new Date(this._correct_shift(t))};scheduler.getActionData=function(n){var t=this._mouse_coords(n);return{date:this._get_date_from_pos(t),section:t.section}};scheduler._focus=function(n,t){if(n&&n.focus)if(this._mobile)window.setTimeout(function(){n.focus()},10);else try{t&&n.select&&n.offsetWidth&&n.select();n.focus()}catch(i){}};scheduler._get_real_event_length=function(n,t,i){var r,u=t-n,h=i._start_correction+i._end_correction||0,o=this["ignore_"+this._mode],s=0,f,e;for(i.render?(s=this._get_date_index(i,n),r=this._get_date_index(i,t)):r=Math.round(u/864e5),f=!0;r>s;)e=scheduler.date.add(t,-i.x_step,i.x_unit),o&&o(t)&&(!f||f&&o(e))?u-=t-e:(f=!1,u-=h),t=e,r--;return u};scheduler._get_fictional_event_length=function(n,t,i,r){var u=new Date(n),f=r?-1:1,l,s,e,c;(i._start_correction||i._end_correction)&&(l=r?60*u.getHours()+u.getMinutes()-60*(i.first_hour||0):60*(i.last_hour||0)-(60*u.getHours()+u.getMinutes()),s=60*(i.last_hour-i.first_hour),e=Math.ceil((t/6e4-l)/s),0>e&&(e=0),t+=e*(1440-s)*6e4);var o,v=new Date(1*n+t*f),a=this["ignore_"+this._mode],h=0;for(i.render?(h=this._get_date_index(i,u),o=this._get_date_index(i,v)):o=Math.round(t/864e5);o*f>=h*f;)c=scheduler.date.add(u,i.x_step*f,i.x_unit),a&&a(u)&&(t+=(c-u)*f,o+=f),u=c,h+=f;return t};scheduler._get_section_view=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode]:this._props&&this._props[this._mode]?this._props[this._mode]:null};scheduler._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null};scheduler._is_initialized=function(){var n=this.getState();return this._obj&&n.date&&n.mode};scheduler._is_lightbox_open=function(){var n=this.getState();return null!==n.lightbox_id&&void 0!==n.lightbox_id};scheduler._getClassName=function(n){if(!n)return"";var t=n.className||"";return t.baseVal&&(t=t.baseVal),t.indexOf||(t=""),t||""};scheduler.$domHelpers={getAbsoluteLeft:function(n){return this.getOffset(n).left},getAbsoluteTop:function(n){return this.getOffset(n).top},getOffsetSum:function(n){for(var t=0,i=0;n;)t+=parseInt(n.offsetTop),i+=parseInt(n.offsetLeft),n=n.offsetParent;return{top:t,left:i}},getOffsetRect:function(n){var i=n.getBoundingClientRect(),f=0,e=0,t,o;if(/Mobi/.test(navigator.userAgent))t=document.createElement("div"),t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.width="1px",t.style.height="1px",document.body.appendChild(t),o=t.getBoundingClientRect(),f=i.top-o.top,e=i.left-o.left,t.parentNode.removeChild(t);else{var r=document.body,u=document.documentElement,s=window.pageYOffset||u.scrollTop||r.scrollTop,h=window.pageXOffset||u.scrollLeft||r.scrollLeft,c=u.clientTop||r.clientTop||0,l=u.clientLeft||r.clientLeft||0;f=i.top+s-c;e=i.left+h-l}return{top:Math.round(f),left:Math.round(e)}},getOffset:function(n){return n.getBoundingClientRect?this.getOffsetRect(n):this.getOffsetSum(n)}};scheduler.$env={isIE:navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,isIE6:!window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,isIE7:navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,isIE8:navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,isOpera:navigator.userAgent.indexOf("Opera")>=0,isChrome:navigator.userAgent.indexOf("Chrome")>=0,isKHTML:navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,isFF:navigator.userAgent.indexOf("Firefox")>=0,isIPad:navigator.userAgent.search(/iPad/gi)>=0,isEdge:-1!=navigator.userAgent.indexOf("Edge")};scheduler.$ajax={_obj:scheduler,cache:!0,method:"get",parse:function(n){if("string"!=typeof n)return n;var t;return n=n.replace(/^[\s]+/,""),window.DOMParser&&!scheduler.$env.isIE?t=(new window.DOMParser).parseFromString(n,"text/xml"):window.ActiveXObject!==window.undefined&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)),t},xmltop:function(n,t,i){if("undefined"==typeof t.status||t.status<400){var r=t.responseXML?t.responseXML||t:this.parse(t.responseText||t);if(r&&null!==r.documentElement&&!r.getElementsByTagName("parsererror").length)return r.getElementsByTagName(n)[0]}return-1!==i&&this._obj.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],i]),document.createElement("DIV")},xpath:function(n,t){if(t.nodeName||(t=t.responseXML||t),scheduler.$env.isIE)return t.selectNodes(n)||[];for(var i,r=[],u=(t.ownerDocument||t).evaluate(n,t,null,XPathResult.ANY_TYPE,null);;){if(i=u.iterateNext(),!i)break;r.push(i)}return r},query:function(n){this._call(n.method||"GET",n.url,n.data||"",n.async||!0,n.callback,null,n.headers)},get:function(n,t){this._call("GET",n,null,!0,t)},getSync:function(n){return this._call("GET",n,null,!1)},put:function(n,t,i){this._call("PUT",n,t,!0,i)},del:function(n,t,i){this._call("DELETE",n,t,!0,i)},post:function(n,t,i){1==arguments.length?t="":2!=arguments.length||"function"!=typeof t&&"function"!=typeof window[t]?t=String(t):(i=t,t="");this._call("POST",n,t,!0,i)},postSync:function(n,t){return t=null===t?"":String(t),this._call("POST",n,t,!1)},getLong:function(n,t){this._call("GET",n,null,!0,t,{url:n})},postLong:function(n,t,i){2==arguments.length&&(i=t,t="");this._call("POST",n,t,!0,i,{url:n,postData:t})},_call:function(n,t,i,r,u,f,e){var h=this._obj,o=window.XMLHttpRequest&&!h.$env.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c=null!==navigator.userAgent.match(/AppleWebKit/)&&null!==navigator.userAgent.match(/Qt/)&&null!==navigator.userAgent.match(/Safari/),s;if(r&&(o.onreadystatechange=function(){if(4==o.readyState||c&&3==o.readyState){if((200!=o.status||""===o.responseText)&&!h.callEvent("onAjaxError",[o]))return;window.setTimeout(function(){"function"==typeof u&&u.apply(window,[{xmlDoc:o,filePath:t}]);f&&("undefined"!=typeof f.postData?this.postLong(f.url,f.postData,u):this.getLong(f.url,u));u=null;o=null},1)}}),"GET"!=n||this.cache||(t+=(t.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),o.open(n,t,r),e)for(s in e)o.setRequestHeader(s,e[s]);else"POST"==n.toUpperCase()||"PUT"==n||"DELETE"==n?o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==n&&(i=null);return o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(i),r?void 0:{xmlDoc:o,filePath:t}},urlSeparator:function(n){return-1!=n.indexOf("?")?"&":"?"}};scheduler.date={init:function(){for(var t=scheduler.locale.date.month_short,i=scheduler.locale.date.month_short_hash={},n=0;n<t.length;n++)i[t[n]]=n;for(var t=scheduler.locale.date.month_full,i=scheduler.locale.date.month_full_hash={},n=0;n<t.length;n++)i[t[n]]=n},date_part:function(n){var t=new Date(n);return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n.getHours()&&(n.getDate()<t.getDate()||n.getMonth()<t.getMonth()||n.getFullYear()<t.getFullYear())&&n.setTime(n.getTime()+36e5*(24-n.getHours())),n},time_part:function(n){return(n.valueOf()/1e3-60*n.getTimezoneOffset())%86400},week_start:function(n){var t=n.getDay();return scheduler.config.start_on_monday&&(0===t?t=6:t--),this.date_part(this.add(n,-1*t,"day"))},month_start:function(n){return n.setDate(1),this.date_part(n)},year_start:function(n){return n.setMonth(0),this.month_start(n)},day_start:function(n){return this.date_part(n)},_add_days:function(n,t){var i=new Date(n.valueOf()),u,r,f;return(i.setDate(i.getDate()+t),t==Math.round(t)&&t>0)&&(u=+i-+n,r=u%864e5,r&&n.getTimezoneOffset()==i.getTimezoneOffset()&&(f=r/36e5,i.setTime(i.getTime()+36e5*(24-f)))),t>=0&&!n.getHours()&&i.getHours()&&(i.getDate()<n.getDate()||i.getMonth()<n.getMonth()||i.getFullYear()<n.getFullYear())&&i.setTime(i.getTime()+36e5*(24-i.getHours())),i},add:function(n,t,i){var r=new Date(n.valueOf());switch(i){case"day":r=scheduler.date._add_days(r,t);break;case"week":r=scheduler.date._add_days(r,7*t);break;case"month":r.setMonth(r.getMonth()+t);break;case"year":r.setYear(r.getFullYear()+t);break;case"hour":r.setTime(r.getTime()+36e5*t);break;case"minute":r.setTime(r.getTime()+6e4*t);break;default:return scheduler.date["add_"+i](n,t,i)}return r},to_fixed:function(n){return 10>n?"0"+n:n},copy:function(n){return new Date(n.valueOf())},date_to_str:function(n,t){return n=n.replace(/%[a-zA-Z]/g,function(n){switch(n){case"%d":return'"+scheduler.date.to_fixed(date.getDate())+"';case"%m":return'"+scheduler.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+scheduler.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+scheduler.locale.date.day_short[date.getDay()]+"';case"%l":return'"+scheduler.locale.date.day_full[date.getDay()]+"';case"%M":return'"+scheduler.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+scheduler.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+scheduler.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+scheduler.date.to_fixed(date.getHours())+"';case"%i":return'"+scheduler.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+scheduler.date.to_fixed(date.getSeconds())+"';case"%W":return'"+scheduler.date.to_fixed(scheduler.date.getISOWeek(date))+"';default:return n}}),t&&(n=n.replace(/date\.get/g,"date.getUTC")),new Function("date",'return "'+n+'";')},str_to_date:function(n,t){for(var u,r="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",f=n.match(/%[a-zA-Z]/g),i=0;i<f.length;i++)switch(f[i]){case"%j":case"%d":r+="set[2]=temp["+i+"]||1;";break;case"%n":case"%m":r+="set[1]=(temp["+i+"]||1)-1;";break;case"%y":r+="set[0]=temp["+i+"]*1+(temp["+i+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":r+="set[3]=temp["+i+"]||0;";break;case"%i":r+="set[4]=temp["+i+"]||0;";break;case"%Y":r+="set[0]=temp["+i+"]||0;";break;case"%a":case"%A":r+="set[3]=set[3]%12+((temp["+i+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":r+="set[5]=temp["+i+"]||0;";break;case"%M":r+="set[1]=scheduler.locale.date.month_short_hash[temp["+i+"]]||0;";break;case"%F":r+="set[1]=scheduler.locale.date.month_full_hash[temp["+i+"]]||0;"}return u="set[0],set[1],set[2],set[3],set[4],set[5]",t&&(u=" Date.UTC("+u+")"),new Function("date","var set=[0,0,1,0,0,0]; "+r+" return new Date("+u+");")},getISOWeek:function(n){var t,i;if(!n)return!1;n=this.date_part(new Date(n));t=n.getDay();0===t&&(t=7);i=new Date(n.valueOf());i.setDate(n.getDate()+(4-t));var r=i.getFullYear(),u=Math.round((i.getTime()-new Date(r,0,1).getTime())/864e5);return 1+Math.floor(u/7)},getUTCISOWeek:function(n){return this.getISOWeek(this.convert_to_utc(n))},convert_to_utc:function(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())}};scheduler.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Do you want to edit the whole set of repeated events?",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute"}};scheduler.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%m/%d/%Y %H:%i",api_date:"%d-%m-%Y %H:%i",preserve_length:!0,time_step:5,start_on_monday:1,first_hour:0,last_hour:24,readonly:!1,drag_resize:1,drag_move:1,drag_create:1,dblclick_create:1,edit_on_create:1,details_on_create:0,resize_month_events:!1,resize_month_timed:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:0,drag_lightbox:!0,preserve_scroll:!0,select:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_left:["dhx_save_btn","dhx_cancel_btn"],buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0,timeline_swap_resize:!0,wai_aria_attributes:!0,wai_aria_application_role:!0};scheduler.config.buttons_left.$inital=scheduler.config.buttons_left.join();scheduler.config.buttons_right.$inital=scheduler.config.buttons_right.join();scheduler.templates={};scheduler.init_templates=function(){var i=scheduler.locale.labels;i.dhx_save_btn=i.icon_save;i.dhx_cancel_btn=i.icon_cancel;i.dhx_delete_btn=i.icon_delete;var t=scheduler.date.date_to_str,n=scheduler.config,r=function(n,t){for(var i in t)n[i]||(n[i]=t[i])};r(scheduler.templates,{day_date:t(n.default_date),month_date:t(n.month_date),week_date:function(n,t){return scheduler.templates.day_date(n)+" &ndash; "+scheduler.templates.day_date(scheduler.date.add(t,-1,"day"))},day_scale_date:t(n.default_date),month_scale_date:t(n.week_date),week_scale_date:t(n.day_date),hour_scale:t(n.hour_date),time_picker:t(n.hour_date),event_date:t(n.hour_date),month_day:t(n.month_day),xml_date:scheduler.date.str_to_date(n.xml_date,n.server_utc),load_format:t(n.load_date),xml_format:t(n.xml_date,n.server_utc),api_date:scheduler.date.str_to_date(n.api_date),event_header:function(n,t){return scheduler.templates.event_date(n)+" - "+scheduler.templates.event_date(t)},event_text:function(n,t,i){return i.text},event_class:function(){return""},month_date_class:function(){return""},week_date_class:function(){return""},event_bar_date:function(n){return scheduler.templates.event_date(n)+" "},event_bar_text:function(n,t,i){return i.text},month_events_link:function(n,t){return"<a>View more("+t+" events)<\/a>"},drag_marker_class:function(){return""},drag_marker_content:function(){return""},tooltip_date_format:scheduler.date.date_to_str("%Y-%m-%d %H:%i"),tooltip_text:function(n,t,i){return"<b>Event:<\/b> "+i.text+"<br/><b>Start date:<\/b> "+scheduler.templates.tooltip_date_format(n)+"<br/><b>End date:<\/b> "+scheduler.templates.tooltip_date_format(t)}});this.callEvent("onTemplatesReady",[])};scheduler.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++};scheduler._events={};scheduler.clearAll=function(){this._events={};this._loaded={};this._edit_id=null;this._select_id=null;this._drag_id=null;this._drag_mode=null;this._drag_pos=null;this.clear_view();this.callEvent("onClearAll",[])};scheduler.addEvent=function(n,t,i,r,u){var f,e,o;return arguments.length?(f=n,1!=arguments.length&&(f=u||{},f.start_date=n,f.end_date=t,f.text=i,f.id=r),f.id=f.id||scheduler.uid(),f.text=f.text||"","string"==typeof f.start_date&&(f.start_date=this.templates.api_date(f.start_date)),"string"==typeof f.end_date&&(f.end_date=this.templates.api_date(f.end_date)),e=6e4*(this.config.event_duration||this.config.time_step),f.start_date.valueOf()==f.end_date.valueOf()&&f.end_date.setTime(f.end_date.valueOf()+e),f._timed=this.isOneDayEvent(f),o=!this._events[f.id],this._events[f.id]=f,this.event_updated(f),this._loading||this.callEvent(o?"onEventAdded":"onEventChanged",[f.id,f]),f.id):this.addEventNow()};scheduler.deleteEvent=function(n,t){var i=this._events[n];(t||this.callEvent("onBeforeEventDelete",[n,i])&&this.callEvent("onConfirmedBeforeEventDelete",[n,i]))&&(i&&(this._select_id=null,delete this._events[n],this.event_updated(i),this._drag_id==i.id&&(this._drag_id=null,this._drag_mode=null,this._drag_pos=null)),this.callEvent("onEventDeleted",[n,i]))};scheduler.getEvent=function(n){return this._events[n]};scheduler.setEvent=function(n,t){t.id||(t.id=n);this._events[n]=t};scheduler.for_rendered=function(n,t){for(var i=this._rendered.length-1;i>=0;i--)this._rendered[i].getAttribute("event_id")==n&&t(this._rendered[i],i)};scheduler.changeEventId=function(n,t){if(n!=t){var i=this._events[n];i&&(i.id=t,this._events[t]=i,delete this._events[n]);this.for_rendered(n,function(n){n.setAttribute("event_id",t)});this._select_id==n&&(this._select_id=t);this._edit_id==n&&(this._edit_id=t);this.callEvent("onEventIdChange",[n,t])}},function(){for(var t=["text","Text","start_date","StartDate","end_date","EndDate"],i=function(n){return function(t){return scheduler.getEvent(t)[n]}},r=function(n){return function(t,i){var r=scheduler.getEvent(t);r[n]=i;r._changed=!0;r._timed=this.isOneDayEvent(r);scheduler.event_updated(r,!0)}},n=0;n<t.length;n+=2)scheduler["getEvent"+t[n+1]]=i(t[n]),scheduler["setEvent"+t[n+1]]=r(t[n])}();scheduler.event_updated=function(n){this.is_visible_events(n)?this.render_view_data():this.clear_event(n.id)};scheduler.is_visible_events=function(n){var o=n.start_date.valueOf()<this._max_date.valueOf()&&this._min_date.valueOf()<n.end_date.valueOf(),f,e;if(o){var t=n.start_date.getHours(),i=n.end_date.getHours()+n.end_date.getMinutes()/60,r=this.config.last_hour,u=this.config.first_hour,s=this._table_view||!((i>r||u>i)&&(t>=r||u>t));return s?!0:(f=(n.end_date.valueOf()-n.start_date.valueOf())/36e5,e=24-(this.config.last_hour-this.config.first_hour),!!(f>e||r>t&&i>=u))}return!1};scheduler.isOneDayEvent=function(n){var t=n.end_date.getDate()-n.start_date.getDate();return t?(0>t&&(t=Math.ceil((n.end_date.valueOf()-n.start_date.valueOf())/864e5)),1==t&&!n.end_date.getHours()&&!n.end_date.getMinutes()&&(n.start_date.getHours()||n.start_date.getMinutes())):n.start_date.getMonth()==n.end_date.getMonth()&&n.start_date.getFullYear()==n.end_date.getFullYear()};scheduler.get_visible_events=function(n){var i=[];for(var t in this._events)this.is_visible_events(this._events[t])&&(!n||this._events[t]._timed)&&this.filter_event(t,this._events[t])&&i.push(this._events[t]);return i};scheduler.filter_event=function(n,t){var i=this["filter_"+this._mode];return i?i(n,t):!0};scheduler._is_main_area_event=function(n){return!!n._timed};scheduler.render_view_data=function(n,t){var r=!1,i,u;if(!n){if(r=!0,this._not_render)return void(this._render_wait=!0);this._render_wait=!1;this.clear_view();n=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(i=0,u=n.length;u>i;i++)this._recalculate_timed(n[i]);if(this.config.multi_day&&!this._table_view){for(var f=[],e=[],i=0;i<n.length;i++)this._is_main_area_event(n[i])?f.push(n[i]):e.push(n[i]);this._rendered_location=this._els.dhx_multi_day[0];this._table_view=!0;this.render_data(e,t);this._table_view=!1;this._rendered_location=this._els.dhx_cal_data[0];this._table_view=!1;this.render_data(f,t)}else this._rendered_location=this._els.dhx_cal_data[0],this.render_data(n,t);r&&this.callEvent("onDataRender",[])};scheduler._view_month_day=function(n){var t=scheduler.getActionData(n).date;scheduler.callEvent("onViewMoreClick",[t])&&scheduler.setCurrentView(t,"day")};scheduler._render_month_link=function(n){for(var f,t,o=this._rendered_location,r=this._lame_clone(n),u=n._sday;u<n._eday;u++){r._sday=u;r._eday=u+1;f=scheduler.date;t=scheduler._min_date;t=f.add(t,r._sweek,"week");t=f.add(t,r._sday,"day");var s=scheduler.getEvents(t,f.add(t,1,"day")).length,e=this._get_event_bar_pos(r),h=e.x2-e.x,i=document.createElement("div");i.onclick=function(n){scheduler._view_month_day(n||event)};i.className="dhx_month_link";i.style.top=e.y+"px";i.style.left=e.x+"px";i.style.width=h+"px";i.innerHTML=scheduler.templates.month_events_link(t,s);this._rendered.push(i);o.appendChild(i)}};scheduler._recalculate_timed=function(n){if(n){var t;t="object"!=typeof n?this._events[n]:n;t&&(t._timed=scheduler.isOneDayEvent(t))}};scheduler.attachEvent("onEventChanged",scheduler._recalculate_timed);scheduler.attachEvent("onEventAdded",scheduler._recalculate_timed);scheduler.render_data=function(n,t){var i,r;for(n=this._pre_render_events(n,t),i=0;i<n.length;i++)this._table_view?"month"!=scheduler._mode?this.render_event_bar(n[i]):(r=scheduler.config.max_month_events,r!==1*r||n[i]._sorder<r?this.render_event_bar(n[i]):void 0!==r&&n[i]._sorder==r&&scheduler._render_month_link(n[i])):this.render_event(n[i])};scheduler._get_first_visible_cell=function(n){for(var t=0;t<n.length;t++)if(-1==(n[t].className||"").indexOf("dhx_scale_ignore"))return n[t];return n[0]};scheduler._pre_render_events=function(n,t){var e=this.xy.bar_height,k=this._colsS.heights,i=this._colsS.heights=[0,0,0,0,0,0,0],o=this._els.dhx_cal_data[0],u,r,s,h,c,l,p,f;if(n=this._table_view?this._pre_render_events_table(n,t):this._pre_render_events_line(n,t),this._table_view)if(t)this._colsS.heights=k;else if(u=o.firstChild,u.rows){for(r=0;r<u.rows.length;r++){if(i[r]++,s=u.rows[r].cells,h=this._colsS.height-this.xy.month_head_height,i[r]*e>h)for(c=h,1*this.config.max_month_events!==this.config.max_month_events||i[r]<=this.config.max_month_events?c=i[r]*e:(this.config.max_month_events+1)*e>h&&(c=(this.config.max_month_events+1)*e),l=0;l<s.length;l++)s[l].childNodes[1].style.height=c+"px";i[r]=(i[r-1]||0)+scheduler._get_first_visible_cell(s).offsetHeight}if(i.unshift(0),u.parentNode.offsetHeight<u.parentNode.scrollHeight&&!scheduler._colsS.scroll_fix&&scheduler.xy.scroll_width){var a=scheduler._colsS,w=a[a.col_length],d=a.heights.slice();w-=scheduler.xy.scroll_width||0;this._calc_scale_sizes(w,this._min_date,this._max_date);scheduler._colsS.heights=d;this.set_xy(this._els.dhx_cal_header[0],w,this.xy.scale_height);scheduler._render_scales(this._els.dhx_cal_header[0]);scheduler._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date);a.scroll_fix=!0}}else if(n.length||"visible"!=this._els.dhx_multi_day[0].style.visibility||(i[0]=-1),n.length||-1==i[0]){var v=(u.parentNode.childNodes,(i[0]+1)*e+1),y=v,b=v+"px";this.config.multi_day_height_limit&&(y=Math.min(v,this.config.multi_day_height_limit),b=y+"px");o.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+y+"px";o.style.height=this._obj.offsetHeight-parseInt(o.style.top,10)-(this.xy.margin_top||0)+"px";p=this._els.dhx_multi_day[0];p.style.height=b;p.style.visibility=-1==i[0]?"hidden":"visible";f=this._els.dhx_multi_day[1];f.style.height=b;f.style.visibility=-1==i[0]?"hidden":"visible";f.className=i[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small";this._dy_shift=(i[0]+1)*e;this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift));i[0]=0;y!=v&&(o.style.top=parseInt(o.style.top)+2+"px",p.style.overflowY="auto",f.style.position="fixed",f.style.top="",f.style.left="")}return n};scheduler._get_event_sday=function(n){var t=this.date.day_start(new Date(n.start_date));return Math.round((t.valueOf()-this._min_date.valueOf())/864e5)};scheduler._get_event_mapped_end_date=function(n){var t=n.end_date,i;return this.config.separate_short_events&&(i=(n.end_date-n.start_date)/6e4,i<this._min_mapped_duration&&(t=this.date.add(t,this._min_mapped_duration-i,"minute"))),t};scheduler._pre_render_events_line=function(n,t){var e,o,r,s,h,y,c,l,u;for(n.sort(function(n,t){return n.start_date.valueOf()==t.start_date.valueOf()?n.id>t.id?1:-1:n.start_date>t.start_date?1:-1}),e=[],o=[],this._min_mapped_duration=Math.ceil(60*this.xy.min_event_height/this.config.hour_size_px),u=0;u<n.length;u++){var i=n[u],b=i.start_date,k=i.end_date,a=b.getHours(),p=k.getHours();if(i._sday=this._get_event_sday(i),this._ignores[i._sday])n.splice(u,1),u--;else{if(e[i._sday]||(e[i._sday]=[]),!t){for(i._inner=!1,r=e[i._sday];r.length;){if(s=r[r.length-1],h=this._get_event_mapped_end_date(s),!(h.valueOf()<=i.start_date.valueOf()))break;r.splice(r.length-1,1)}for(var v=r.length,w=!1,f=0;f<r.length;f++)if(s=r[f],h=this._get_event_mapped_end_date(s),h.valueOf()<=i.start_date.valueOf()){w=!0;i._sorder=s._sorder;v=f;i._inner=!0;break}if(r.length&&(r[r.length-1]._inner=!0),!w)if(r.length)if(r.length<=r[r.length-1]._sorder){if(r[r.length-1]._sorder)for(f=0;f<r.length;f++){for(y=!1,c=0;c<r.length;c++)if(r[c]._sorder==f){y=!0;break}if(!y){i._sorder=f;break}}else i._sorder=0;i._inner=!0}else{for(l=r[0]._sorder,f=1;f<r.length;f++)r[f]._sorder>l&&(l=r[f]._sorder);i._sorder=l+1;i._inner=!1}else i._sorder=0;r.splice(v,v==r.length?0:1,i);r.length>(r.max_count||0)?(r.max_count=r.length,i._count=r.length):i._count=i._count?i._count:1}(a<this.config.first_hour||p>=this.config.last_hour)&&(o.push(i),n[u]=i=this._copy_event(i),a<this.config.first_hour&&(i.start_date.setHours(this.config.first_hour),i.start_date.setMinutes(0)),p>=this.config.last_hour&&(i.end_date.setMinutes(0),i.end_date.setHours(this.config.last_hour)),i.start_date>i.end_date||a==this.config.last_hour)&&(n.splice(u,1),u--)}}if(!t){for(u=0;u<n.length;u++)n[u]._count=e[n[u]._sday].max_count;for(u=0;u<o.length;u++)o[u]._count=e[o[u]._sday].max_count}return n};scheduler._time_order=function(n){n.sort(function(n,t){return n.start_date.valueOf()==t.start_date.valueOf()?n._timed&&!t._timed?1:!n._timed&&t._timed?-1:n.id>t.id?1:-1:n.start_date>t.start_date?1:-1})};scheduler._pre_render_events_table=function(n,t){var i,c,p,w,e,o,r;this._time_order(n);for(var l,a=[],k=[[],[],[],[],[],[],[]],b=this._colsS.heights,u=this._cols.length,v={},h=0;h<n.length;h++){i=n[h];c=i.id;v[c]||(v[c]={first_chunk:!0,last_chunk:!0});var f=v[c],s=l||i.start_date,y=i.end_date;if(s<this._min_date&&(f.first_chunk=!1,s=this._min_date),y>this._max_date&&(f.last_chunk=!1,y=this._max_date),p=this.locate_holder_day(s,!1,i),i._sday=p%u,!this._ignores[i._sday]||!i._timed){for(w=this.locate_holder_day(y,!0,i)||u,i._eday=w%u||u,i._length=w-p,i._sweek=Math.floor((this._correct_shift(s.valueOf(),1)-this._min_date.valueOf())/(864e5*u)),o=k[i._sweek],e=0;e<o.length&&!(o[e]._eday<=i._sday);e++);(i._sorder&&t||(i._sorder=e),i._sday+i._length<=u)?(l=null,a.push(i),o[e]=i,b[i._sweek]=o.length-1,i._first_chunk=f.first_chunk,i._last_chunk=f.last_chunk):(r=this._copy_event(i),r.id=i.id,r._length=u-i._sday,r._eday=u,r._sday=i._sday,r._sweek=i._sweek,r._sorder=i._sorder,r.end_date=this.date.add(s,r._length,"day"),r._first_chunk=f.first_chunk,f.first_chunk&&(f.first_chunk=!1),a.push(r),o[e]=r,l=r.end_date,b[i._sweek]=o.length-1,h--)}}return a};scheduler._copy_dummy=function(){var n=new Date(this.start_date),t=new Date(this.end_date);this.start_date=n;this.end_date=t};scheduler._copy_event=function(n){return this._copy_dummy.prototype=n,new this._copy_dummy};scheduler._rendered=[];scheduler.clear_view=function(){for(var t,n=0;n<this._rendered.length;n++)t=this._rendered[n],t.parentNode&&t.parentNode.removeChild(t);this._rendered=[]};scheduler.updateEvent=function(n){var t=this.getEvent(n);this.clear_event(n);t&&this.is_visible_events(t)&&this.filter_event(n,t)&&(this._table_view||this.config.multi_day||t._timed)&&(this.config.update_render?this.render_view_data():"month"!=this.getState().mode||this.getState().drag_id||this.isOneDayEvent(t)?this.render_view_data([t],!0):this.render_view_data())};scheduler.clear_event=function(n){this.for_rendered(n,function(n,t){n.parentNode&&n.parentNode.removeChild(n);scheduler._rendered.splice(t,1)})};scheduler._y_from_date=function(n){var t=60*n.getHours()+n.getMinutes();return Math.round((6e4*t-36e5*this.config.first_hour)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)};scheduler._calc_event_y=function(n,t){t=t||0;var i=60*n.start_date.getHours()+n.start_date.getMinutes(),r=60*n.end_date.getHours()+n.end_date.getMinutes()||60*scheduler.config.last_hour,u=this._y_from_date(n.start_date),f=Math.max(t,(r-i)*this.config.hour_size_px/60);return{top:u,height:f}};scheduler.render_event=function(n){var s=scheduler.xy.menu_width,h=this.config.use_select_menu_space?0:s,f,p,w,d,t,b,u,a;if(!(n._sday<0)&&(f=scheduler.locate_holder(n._sday),f)){var k=this._calc_event_y(n,scheduler.xy.min_event_height),v=k.top,c=k.height,y=n._count||1,l=n._sorder||0,i=Math.floor((f.clientWidth-h)/y),r=l*i+1;if((n._inner||(i*=y-l),this.config.cascade_event_display)&&(p=this.config.cascade_event_count,w=this.config.cascade_event_margin,r=l%p*w,d=n._inner?(y-l-1)%p*w/2:0,i=Math.floor(f.clientWidth-h-r-d)),t=this._render_v_bar(n,h+r,v,i,c,n._text_style,scheduler.templates.event_header(n.start_date,n.end_date,n),scheduler.templates.event_text(n.start_date,n.end_date,n)),(this._waiAria.eventAttr(n,t),this._rendered.push(t),f.appendChild(t),r=r+parseInt(f.style.left,10)+h,this._edit_id==n.id)&&(t.style.zIndex=1,i=Math.max(i-4,scheduler.xy.editor_width),t=document.createElement("div"),t.setAttribute("event_id",n.id),this._waiAria.eventAttr(n,t),this.set_xy(t,i,c-20,r,v+(scheduler.xy.event_header_height||14)),t.className="dhx_cal_event dhx_cal_editor",n.color&&(t.style.backgroundColor=n.color),b=scheduler.templates.event_class(n.start_date,n.end_date,n),b&&(t.className+=" "+b),u=document.createElement("div"),this.set_xy(u,i-6,c-26),u.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",t.appendChild(u),this._els.dhx_cal_data[0].appendChild(t),this._rendered.push(t),u.innerHTML="<textarea class='dhx_cal_editor'>"+n.text+"<\/textarea>",this._quirks7&&(u.firstChild.style.height=c-12+"px"),this._editor=u.firstChild,this._editor.onkeydown=function(n){if((n||event).shiftKey)return!0;var t=(n||event).keyCode;t==scheduler.keys.edit_save&&scheduler.editStop(!0);t==scheduler.keys.edit_cancel&&scheduler.editStop(!1);(t==scheduler.keys.edit_save||t==scheduler.keys.edit_cancel)&&n.preventDefault&&n.preventDefault()},this._editor.onselectstart=function(n){return(n||event).cancelBubble=!0,!0},scheduler._focus(u.firstChild,!0),this._els.dhx_cal_data[0].scrollLeft=0),0!==this.xy.menu_width&&this._select_id==n.id){this.config.cascade_event_display&&this._drag_mode&&(t.style.zIndex=1);for(var g,e=this.config["icons_"+(this._edit_id==n.id?"edit":"select")],nt="",tt=n.color?"background-color: "+n.color+";":"",it=n.textColor?"color: "+n.textColor+";":"",o=0;o<e.length;o++)g=this._waiAria.eventMenuAttrString(e[o]),nt+="<div class='dhx_menu_icon "+e[o]+"' style='"+tt+it+"' title='"+this.locale.labels[e[o]]+"'"+g+"><\/div>";a=this._render_v_bar(n,r-s+1,v,s,20*e.length+26-2,"","<div style='"+tt+it+"' class='dhx_menu_head'><\/div>",nt,!0);a.style.left=r-s+1;this._els.dhx_cal_data[0].appendChild(a);this._rendered.push(a)}this.config.drag_highlight&&this._drag_id==n.id&&this.highlightEventPosition(n)}};scheduler._render_v_bar=function(n,t,i,r,u,f,e,o,s){var w=document.createElement("div"),g=n.id,h=s?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",d=scheduler.getState(),b,c,a,p;d.drag_id==n.id&&(h+=" dhx_cal_event_drag");d.select_id==n.id&&(h+=" dhx_cal_event_selected");b=scheduler.templates.event_class(n.start_date,n.end_date,n);b&&(h=h+" "+b);this.config.cascade_event_display&&(h+=" dhx_cal_event_cascade");var v=n.color?"background-color:"+n.color+";":"",k=n.textColor?"color:"+n.textColor+";":"",l=scheduler._border_box_bvents(),y=r-2,nt=l?y:r-4,tt=l?y:r-6,it=l?y:r-(this._quirks?4:14),rt=l?y-2:r-8,ut=l?u-this.xy.event_header_height-1:u-(this._quirks?20:30)+1,ft='<div event_id="'+g+'" class="'+h+'" style="position:absolute; top:'+i+"px; left:"+t+"px; width:"+nt+"px; height:"+u+"px;"+(f||"")+'"><\/div>';return(w.innerHTML=ft,c=w.cloneNode(!0).firstChild,!s&&scheduler.renderEvent(c,n,r,u,e,o))?c:(c=w.firstChild,a='<div class="dhx_event_move dhx_header" style=" width:'+tt+"px;"+v+'" >&nbsp;<\/div>',a+='<div class="dhx_event_move dhx_title" style="'+v+k+'">'+e+"<\/div>",a+='<div class="dhx_body" style=" width:'+it+"px; height:"+ut+"px;"+v+k+'">'+o+"<\/div>",p="dhx_event_resize dhx_footer",s&&(p="dhx_resize_denied "+p),a+='<div class="'+p+'" style=" width:'+rt+"px;"+(s?" margin-top:-1px;":"")+v+k+'" ><\/div>',c.innerHTML=a,c)};scheduler.renderEvent=function(){return!1};scheduler.locate_holder=function(n){return"day"==this._mode?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[n]};scheduler.locate_holder_day=function(n,t){var i=Math.floor((this._correct_shift(n,1)-this._min_date)/864e5);return t&&this.date.time_part(n)&&i++,i};scheduler._get_dnd_order=function(n,t,i){if(!this._drag_event)return n;this._drag_event._orig_sorder?n=this._drag_event._orig_sorder:this._drag_event._orig_sorder=n;for(var r=t*n;r+t>i;)n--,r-=t;return Math.max(n,0)};scheduler._get_event_bar_pos=function(n){var u=this._colsS[n._sday],i=this._colsS[n._eday],r,t,f,e,o;return i==u&&(i=this._colsS[n._eday+1]),r=this.xy.bar_height,t=n._sorder,n.id==this._drag_id&&(f=this._colsS.heights[n._sweek+1]-this._colsS.heights[n._sweek]-this.xy.month_head_height,t=scheduler._get_dnd_order(t,r,f)),e=t*r,o=this._colsS.heights[n._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+e,{x:u,x2:i,y:o}};scheduler.render_event_bar=function(n){var a=this._rendered_location,u=this._get_event_bar_pos(n),v=u.y,s=u.x,h=u.x2,f="",o;if(h){var r=scheduler.config.resize_month_events&&"month"==this._mode&&(!n._timed||scheduler.config.resize_month_timed),e=document.createElement("div"),c=n.hasOwnProperty("_first_chunk")&&n._first_chunk,l=n.hasOwnProperty("_last_chunk")&&n._last_chunk,y=r&&(n._timed||c),p=r&&(n._timed||l),t="dhx_cal_event_clear";(!n._timed||r)&&(t="dhx_cal_event_line");c&&(t+=" dhx_cal_event_line_start");l&&(t+=" dhx_cal_event_line_end");y&&(f+="<div class='dhx_event_resize dhx_event_resize_start'><\/div>");p&&(f+="<div class='dhx_event_resize dhx_event_resize_end'><\/div>");o=scheduler.templates.event_class(n.start_date,n.end_date,n);o&&(t+=" "+o);var w=n.color?"background:"+n.color+";":"",b=n.textColor?"color:"+n.textColor+";":"",k=["position:absolute","top:"+v+"px","left:"+s+"px","width:"+(h-s-15)+"px",b,w,n._text_style||""].join(";"),i="<div event_id='"+n.id+"' class='"+t+"' style='"+k+"'"+this._waiAria.eventBarAttrString(n)+">";r&&(i+=f);"month"==scheduler.getState().mode&&(n=scheduler.getEvent(n.id));n._timed&&(i+=scheduler.templates.event_bar_date(n.start_date,n.end_date,n));i+=scheduler.templates.event_bar_text(n.start_date,n.end_date,n)+"<\/div>";i+="<\/div>";e.innerHTML=i;this._rendered.push(e.firstChild);a.appendChild(e.firstChild)}};scheduler._locate_event=function(n){for(var t=null;n&&!t&&n.getAttribute;)t=n.getAttribute("event_id"),n=n.parentNode;return t};scheduler._locate_css=function(n,t,i){var r,u,f,e,o;for(void 0===i&&(i=!0),r=n.target||n.srcElement,u="";r;){if((u=scheduler._getClassName(r))&&(f=u.indexOf(t),f>=0&&(!i||(e=0===f||!scheduler._trim(u.charAt(f-1)),o=f+t.length>=u.length||!scheduler._trim(u.charAt(f+t.length)),e&&o))))return r;r=r.parentNode}return null};scheduler.edit=function(n){this._edit_id!=n&&(this.editStop(!1,n),this._edit_id=n,this.updateEvent(n))};scheduler.editStop=function(n,t){if(!t||this._edit_id!=t){var i=this.getEvent(this._edit_id);i&&(n&&(i.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(i.id),this._edit_stop_event(i,n))}};scheduler._edit_stop_event=function(n,t){this._new_event?(t?this.callEvent("onEventAdded",[n.id,n]):n&&this.deleteEvent(n.id,!0),this._new_event=null):t&&this.callEvent("onEventChanged",[n.id,n])};scheduler.getEvents=function(n,t){var r=[],u,i;for(u in this._events)i=this._events[u],i&&(!n&&!t||i.start_date<t&&i.end_date>n)&&r.push(i);return r};scheduler.getRenderedEvent=function(n){var i,t,r;if(n){for(i=scheduler._rendered,t=0;t<i.length;t++)if(r=i[t],r.getAttribute("event_id")==n)return r;return null}};scheduler.showEvent=function(n,t){var i="number"==typeof n||"string"==typeof n?scheduler.getEvent(n):n,u,f,e,o,r;(t=t||scheduler._mode,i&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[i,t])))&&(u=scheduler.config.scroll_hour,scheduler.config.scroll_hour=i.start_date.getHours(),f=scheduler.config.preserve_scroll,scheduler.config.preserve_scroll=!1,e=i.color,o=i.textColor,(scheduler.config.highlight_displayed_event&&(i.color=scheduler.config.displayed_event_color,i.textColor=scheduler.config.displayed_event_text_color),scheduler.setCurrentView(new Date(i.start_date),t),i.color=e,i.textColor=o,scheduler.config.scroll_hour=u,scheduler.config.preserve_scroll=f,scheduler.matrix&&scheduler.matrix[t])&&(r=scheduler.getRenderedEvent(i.id),r&&(scheduler._els.dhx_cal_data[0].scrollTop=scheduler.$domHelpers.getAbsoluteTop(r)-scheduler.$domHelpers.getAbsoluteTop(scheduler._els.dhx_cal_data[0])-20)),scheduler.callEvent("onAfterEventDisplay",[i,t]))};scheduler._append_drag_marker=function(n){if(!n.parentNode){var r=scheduler._els.dhx_cal_data[0],t=r.lastChild,i=scheduler._getClassName(t);i.indexOf("dhx_scale_holder")<0&&t.previousSibling&&(t=t.previousSibling);i=scheduler._getClassName(t);t&&0===i.indexOf("dhx_scale_holder")&&t.appendChild(n)}};scheduler._update_marker_position=function(n,t){var i=scheduler._calc_event_y(t,0);n.style.top=i.top+"px";n.style.height=i.height+"px"};scheduler.highlightEventPosition=function(n){var t=document.createElement("div"),i,r;t.setAttribute("event_id",n.id);this._rendered.push(t);this._update_marker_position(t,n);i=this.templates.drag_marker_class(n.start_date,n.end_date,n);r=this.templates.drag_marker_content(n.start_date,n.end_date,n);t.className="dhx_drag_marker";i&&(t.className+=" "+i);r&&(t.innerHTML=r);this._append_drag_marker(t)};scheduler._loaded={};scheduler._load=function(n,t){var i,r,f,u;if(n=n||this._load_url){if(n+=(-1==n.indexOf("?")?"?":"&")+"timeshift="+(new Date).getTimezoneOffset(),this.config.prevent_cache&&(n+="&uid="+this.uid()),t=t||this._date,this._load_mode){for(r=this.templates.load_format,t=this.date[this._load_mode+"_start"](new Date(t.valueOf()));t>this._min_date;)t=this.date.add(t,-1,this._load_mode);for(i=t,f=!0;i<this._max_date;)i=this.date.add(i,1,this._load_mode),this._loaded[r(t)]&&f?t=this.date.add(t,1,this._load_mode):f=!1;u=i;do i=u,u=this.date.add(i,-1,this._load_mode);while(u>t&&this._loaded[r(u)]);if(t>=i)return!1;for(scheduler.$ajax.get(n+"&from="+r(t)+"&to="+r(i),function(n){scheduler.on_load(n)});i>t;)this._loaded[r(t)]=!0,t=this.date.add(t,1,this._load_mode)}else scheduler.$ajax.get(n,function(n){scheduler.on_load(n)});return this.callEvent("onXLS",[]),!0}};scheduler.on_load=function(n){var t,i=!1;if(this._process&&"xml"!=this._process)try{t=this[this._process].parse(n.xmlDoc.responseText)}catch(r){i=!0}else t=this._magic_parser(n),t||(i=!0);(i||n.xmlDoc.status&&n.xmlDoc.status>=400)&&(this.callEvent("onLoadError",[n.xmlDoc]),t=[]);scheduler._process_loading(t);this.callEvent("onXLE",[])};scheduler._process_loading=function(n){this._loading=!0;this._not_render=!0;for(var t=0;t<n.length;t++)this.callEvent("onEventLoading",[n[t]])&&this.addEvent(n[t]);this._not_render=!1;this._render_wait&&this.render_view_data();this._loading=!1;this._after_call&&this._after_call();this._after_call=null};scheduler._init_event=function(n){n.text=n.text||n._tagvalue||"";n.start_date=scheduler._init_date(n.start_date);n.end_date=scheduler._init_date(n.end_date)};scheduler._init_date=function(n){return n?"string"==typeof n?scheduler.templates.xml_date(n):new Date(n):null};scheduler.json={};scheduler.json.parse=function(n){var u,s,f,h,r,e,t,c,i,l,o,a;"string"==typeof n&&(scheduler._temp=window.JSON?JSON.parse(n):eval("("+n+")"),n=scheduler._temp?scheduler._temp.data||scheduler._temp.d||scheduler._temp:[]);n.dhx_security&&(dhtmlx.security_key=n.dhx_security);u=scheduler._temp&&scheduler._temp.collections?scheduler._temp.collections:{};s=!1;for(f in u)if(u.hasOwnProperty(f)){if(s=!0,h=u[f],r=scheduler.serverList[f],!r)continue;for(r.splice(0,r.length),e=0;e<h.length;e++){t=h[e];c={key:t.value,label:t.label};for(i in t)if(t.hasOwnProperty(i)){if("value"==i||"label"==i)continue;c[i]=t[i]}r.push(c)}}for(s&&scheduler.callEvent("onOptionsLoad",[]),l=[],o=0;o<n.length;o++)a=n[o],scheduler._init_event(a),l.push(a);return l};scheduler.parse=function(n,t){this._process=t;this.on_load({xmlDoc:{responseText:n}})};scheduler.load=function(n,t){"string"==typeof t&&(this._process=t,t=arguments[2]);this._load_url=n;this._after_call=t;this._load(n,this._date)};scheduler.setLoadMode=function(n){"all"==n&&(n="");this._load_mode=n};scheduler.serverList=function(n,t){return t?(this.serverList[n]=t.slice(0),this.serverList[n]):(this.serverList[n]=this.serverList[n]||[],this.serverList[n])};scheduler._userdata={};scheduler._magic_parser=function(n){var i,s,u,v,f,e,r,o,c,l,a,t,w;if(n.getXMLTopNode||(n=scheduler.$ajax.parse(n)),i=scheduler.$ajax.xmltop("data",n.xmlDoc),"data"!=i.tagName)return null;for(s=i.getAttribute("dhx_security"),s&&(dhtmlx.security_key=s),u=scheduler.$ajax.xpath("//coll_options",n.xmlDoc),t=0;t<u.length;t++)if(v=u[t].getAttribute("for"),f=this.serverList[v],f)for(f.splice(0,f.length),e=scheduler.$ajax.xpath(".//item",u[t]),r=0;r<e.length;r++){for(var b=e[r],y=b.attributes,p={key:e[r].getAttribute("value"),label:e[r].getAttribute("label")},h=0;h<y.length;h++)o=y[h],"value"!=o.nodeName&&"label"!=o.nodeName&&(p[o.nodeName]=o.nodeValue);f.push(p)}for(u.length&&scheduler.callEvent("onOptionsLoad",[]),c=scheduler.$ajax.xpath("//userdata",n.xmlDoc),t=0;t<c.length;t++)l=this._xmlNodeToJSON(c[t]),this._userdata[l.name]=l.text;for(a=[],i=scheduler.$ajax.xpath("//event",n.xmlDoc),t=0;t<i.length;t++)w=a[t]=this._xmlNodeToJSON(i[t]),scheduler._init_event(w);return a};scheduler._xmlNodeToJSON=function(n){for(var r,i={},t=0;t<n.attributes.length;t++)i[n.attributes[t].name]=n.attributes[t].value;for(t=0;t<n.childNodes.length;t++)r=n.childNodes[t],1==r.nodeType&&(i[r.tagName]=r.firstChild?r.firstChild.nodeValue:"");return i.text||(i.text=n.firstChild?n.firstChild.nodeValue:""),i};scheduler.attachEvent("onXLS",function(){if(this.config.show_loading===!0){var n;n=this.config.show_loading=document.createElement("div");n.className="dhx_loading";n.style.left=Math.round((this._x-128)/2)+"px";n.style.top=Math.round((this._y-15)/2)+"px";this._obj.appendChild(n)}});scheduler.attachEvent("onXLE",function(){var n=this.config.show_loading;n&&"object"==typeof n&&(this._obj.removeChild(n),this.config.show_loading=!0)});scheduler.ical={parse:function(n){var t=n.match(RegExp(this.c_start+"[^\f]*"+this.c_end,"")),u,r,f,e,i,o;if(t.length){for(t[0]=t[0].replace(/[\r\n]+ /g,""),t[0]=t[0].replace(/[\r\n]+(?=[a-z \t])/g," "),t[0]=t[0].replace(/\;[^:\r\n]*:/g,":"),r=[],f=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");null!==(u=f.exec(t));){for(i={},o=/[^\r\n]+[\r\n]+/g;null!==(e=o.exec(u[1]));)this.parse_param(e.toString(),i);i.uid&&!i.id&&(i.id=i.uid);r.push(i)}return r}},parse_param:function(n,t){var u=n.indexOf(":"),i,r;-1!=u&&(i=n.substr(0,u).toLowerCase(),r=n.substr(u+1).replace(/\\\,/g,",").replace(/[\r\n]+$/,""),"summary"==i?i="text":"dtstart"==i?(i="start_date",r=this.parse_date(r,0,0)):"dtend"==i&&(i="end_date",r=this.parse_date(r,0,0)),t[i]=r)},parse_date:function(n,t,i){var r=n.split("T");r[1]&&(t=r[1].substr(0,2),i=r[1].substr(2,2));var u=r[0].substr(0,4),f=parseInt(r[0].substr(4,2),10)-1,e=r[0].substr(6,2);return scheduler.config.server_utc&&!r[1]?new Date(Date.UTC(u,f,e,t,i)):new Date(u,f,e,t,i)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"};scheduler._lightbox_controls={};scheduler.formSection=function(n){var r=this.config.lightbox.sections,i=0,t;for(i;i<r.length&&r[i].name!=n;i++);t=r[i];scheduler._lightbox||scheduler.getLightbox();var f=document.getElementById(t.id),u=f.nextSibling,e={section:t,header:f,node:u,getValue:function(n){return scheduler.form_blocks[t.type].get_value(u,n||{},t)},setValue:function(n,i){return scheduler.form_blocks[t.type].set_value(u,n,i||{},t)}},o=scheduler._lightbox_controls["get_"+t.type+"_control"];return o?o(e):e};scheduler._lightbox_controls.get_template_control=function(n){return n.control=n.node,n};scheduler._lightbox_controls.get_select_control=function(n){return n.control=n.node.getElementsByTagName("select")[0],n};scheduler._lightbox_controls.get_textarea_control=function(n){return n.control=n.node.getElementsByTagName("textarea")[0],n};scheduler._lightbox_controls.get_time_control=function(n){return n.control=n.node.getElementsByTagName("select"),n};scheduler._lightbox_controls.defaults={template:{height:30},textarea:{height:200},select:{height:23},time:{height:20}};scheduler.form_blocks={template:{render:function(n){var t=scheduler._lightbox_controls.defaults.template,i=t?t.height:30,r=(n.height||i||30)+"px";return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+r+";'><\/div>"},set_value:function(n,t){n.innerHTML=t||""},get_value:function(n){return n.innerHTML||""},focus:function(){}},textarea:{render:function(n){var t=scheduler._lightbox_controls.defaults.textarea,i=t?t.height:200,r=(n.height||i||"130")+"px";return"<div class='dhx_cal_ltext' style='height:"+r+";'><textarea><\/textarea><\/div>"},set_value:function(n,t){scheduler.form_blocks.textarea._get_input(n).value=t||""},get_value:function(n){return scheduler.form_blocks.textarea._get_input(n).value},focus:function(n){var t=scheduler.form_blocks.textarea._get_input(n);scheduler._focus(t,!0)},_get_input:function(n){return n.getElementsByTagName("textarea")[0]}},select:{render:function(n){for(var i=scheduler._lightbox_controls.defaults.select,u=i?i.height:23,f=(n.height||u||"23")+"px",r="<div class='dhx_cal_ltext' style='height:"+f+";'><select style='width:100%;'>",t=0;t<n.options.length;t++)r+="<option value='"+n.options[t].key+"'>"+n.options[t].label+"<\/option>";return r+"<\/select><\/div>"},set_value:function(n,t,i,r){var u=n.firstChild;!u._dhx_onchange&&r.onchange&&(u.onchange=r.onchange,u._dhx_onchange=!0);"undefined"==typeof t&&(t=(u.options[0]||{}).value);u.value=t||""},get_value:function(n){return n.firstChild.value},focus:function(n){var t=n.firstChild;scheduler._focus(t,!0)}},time:{render:function(n){var e,r,s,f,u,h,t,v,y,p,w,b;n.time_format||(n.time_format=["%H:%i","%d","%m","%Y"]);n._time_format_order={};var c=n.time_format,o=scheduler.config,i=scheduler.date.date_part(scheduler._currentDate()),l=1440,a=0;for(scheduler.config.limit_time_select&&(l=60*o.last_hour+1,a=60*o.first_hour,i.setHours(o.first_hour)),e="",r=0;r<c.length;r++){s=c[r];r>0&&(e+=" ");f="";u="";switch(s){case"%Y":for(f="dhx_lightbox_year_select",n._time_format_order[3]=r,h=i.getFullYear()-5,t=0;10>t;t++)u+="<option value='"+(h+t)+"'>"+(h+t)+"<\/option>";break;case"%m":for(f="dhx_lightbox_month_select",n._time_format_order[2]=r,t=0;12>t;t++)u+="<option value='"+t+"'>"+this.locale.date.month_full[t]+"<\/option>";break;case"%d":for(f="dhx_lightbox_day_select",n._time_format_order[1]=r,t=1;32>t;t++)u+="<option value='"+t+"'>"+t+"<\/option>";break;case"%H:%i":for(f="dhx_lightbox_time_select",n._time_format_order[0]=r,t=a,v=i.getDate(),n._time_values=[];l>t;)y=this.templates.time_picker(i),u+="<option value='"+t+"'>"+y+"<\/option>",n._time_values.push(t),i.setTime(i.valueOf()+6e4*this.config.time_step),p=i.getDate()!=v?1:0,t=1440*p+60*i.getHours()+i.getMinutes()}u&&(w=scheduler._waiAria.lightboxSelectAttrString(s),b=n.readonly?"disabled='disabled'":"",e+="<select class='"+f+"' "+b+w+">"+u+"<\/select> ")}var k=scheduler._lightbox_controls.defaults.select,d=k?k.height:23,g=d||30;return"<div style='height:"+g+"px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+e+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; <\/span>"+e+"<\/div>"},set_value:function(n,t,i,r){function h(n,t,i){for(var e,c=r._time_values,u=60*i.getHours()+i.getMinutes(),o=u,s=!1,h=0;h<c.length;h++){if(e=c[h],e===u){s=!0;break}u>e&&(o=e)}n[t+f[0]].value=s?u:o;s||o||(n[t+f[0]].selectedIndex=-1);n[t+f[1]].value=i.getDate();n[t+f[2]].value=i.getMonth();n[t+f[3]].value=i.getFullYear()}var s,e,a=scheduler.config,u=n.getElementsByTagName("select"),f=r._time_format_order,c,o,v,l;if(a.full_day&&(n._full_day||(c="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+scheduler.locale.labels.full_day+"&nbsp;<\/label><\/input>",scheduler.config.wide_form||(c=n.previousSibling.innerHTML+c),n.previousSibling.innerHTML=c,n._full_day=!0),o=n.previousSibling.getElementsByTagName("input")[0],o.checked=0===scheduler.date.time_part(i.start_date)&&0===scheduler.date.time_part(i.end_date),u[f[0]].disabled=o.checked,u[f[0]+u.length/2].disabled=o.checked,o.onclick=function(){if(o.checked){var t={};scheduler.form_blocks.time.get_value(n,t,r);s=scheduler.date.date_part(t.start_date);e=scheduler.date.date_part(t.end_date);(+e==+s||+e>=+s&&(0!==i.end_date.getHours()||0!==i.end_date.getMinutes()))&&(e=scheduler.date.add(e,1,"day"))}else s=null,e=null;u[f[0]].disabled=o.checked;u[f[0]+u.length/2].disabled=o.checked;h(u,0,s||i.start_date);h(u,4,e||i.end_date)}),a.auto_end_date&&a.event_duration)for(v=function(){s=new Date(u[f[3]].value,u[f[2]].value,u[f[1]].value,0,u[f[0]].value);e=new Date(s.getTime()+6e4*scheduler.config.event_duration);h(u,4,e)},l=0;4>l;l++)u[l].onchange=v;h(u,0,i.start_date);h(u,4,i.end_date)},get_value:function(n,t,i){var r=n.getElementsByTagName("select"),u=i._time_format_order,f;return(t.start_date=new Date(r[u[3]].value,r[u[2]].value,r[u[1]].value,0,r[u[0]].value),t.end_date=new Date(r[u[3]+4].value,r[u[2]+4].value,r[u[1]+4].value,0,r[u[0]+4].value),r[u[3]].value&&r[u[3]+4].value)||(f=scheduler.getEvent(scheduler._lightbox_id),f&&(t.start_date=f.start_date,t.end_date=f.end_date)),t.end_date<=t.start_date&&(t.end_date=scheduler.date.add(t.start_date,scheduler.config.time_step,"minute")),{start_date:new Date(t.start_date),end_date:new Date(t.end_date)}},focus:function(n){scheduler._focus(n.getElementsByTagName("select")[0])}}};scheduler.showCover=function(n){if(n){n.style.display="block";var t=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,r=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,i=window.innerHeight||document.documentElement.clientHeight;n.style.top=t?Math.round(t+Math.max((i-n.offsetHeight)/2,0))+"px":Math.round(Math.max((i-n.offsetHeight)/2,0)+9)+"px";n.style.left=document.documentElement.scrollWidth>document.body.offsetWidth?Math.round(r+(document.body.offsetWidth-n.offsetWidth)/2)+"px":Math.round((document.body.offsetWidth-n.offsetWidth)/2)+"px"}this.show_cover()};scheduler.showLightbox=function(n){if(n){if(!this.callEvent("onBeforeLightbox",[n]))return void(this._new_event&&(this._new_event=null));var t=this.getLightbox();this.showCover(t);this._fill_lightbox(n,t);this._waiAria.lightboxVisibleAttr(t);this.callEvent("onLightbox",[n])}};scheduler._fill_lightbox=function(n,t){var i=this.getEvent(n),e=t.getElementsByTagName("span"),u=[],s,h,c,o,f;for(scheduler.templates.lightbox_header?(u.push(""),s=scheduler.templates.lightbox_header(i.start_date,i.end_date,i),u.push(s),e[1].innerHTML="",e[2].innerHTML=s):(h=this.templates.event_header(i.start_date,i.end_date,i),c=(this.templates.event_bar_text(i.start_date,i.end_date,i)||"").substr(0,70),u.push(h),u.push(c),e[1].innerHTML=h,e[2].innerHTML=c),this._waiAria.lightboxHeader(t,u.join(" ")),o=this.config.lightbox.sections,f=0;f<o.length;f++){var r=o[f],l=scheduler._get_lightbox_section_node(r),a=this.form_blocks[r.type],v=void 0!==i[r.map_to]?i[r.map_to]:r.default_value;a.set_value.call(this,l,v,i,r);o[f].focus&&a.focus.call(this,l)}scheduler._lightbox_id=n};scheduler._get_lightbox_section_node=function(n){return document.getElementById(n.id).nextSibling};scheduler._lightbox_out=function(n){for(var r,u,f,i=this.config.lightbox.sections,t=0;t<i.length;t++)r=document.getElementById(i[t].id),r=r?r.nextSibling:r,u=this.form_blocks[i[t].type],f=u.get_value.call(this,r,n,i[t]),"auto"!=i[t].map_to&&(n[i[t].map_to]=f);return n};scheduler._empty_lightbox=function(n){var i=scheduler._lightbox_id,t=this.getEvent(i);this.getLightbox();this._lame_copy(t,n);this.setEvent(t.id,t);this._edit_stop_event(t,!0);this.render_view_data()};scheduler.hide_lightbox=function(){scheduler.endLightbox(!1,this.getLightbox())};scheduler.hideCover=function(n){n&&(n.style.display="none");this.hide_cover()};scheduler.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover);this._cover=null};scheduler.show_cover=function(){if(!this._cover){this._cover=document.createElement("div");this._cover.className="dhx_cal_cover";var n=void 0!==document.height?document.height:document.body.offsetHeight,t=document.documentElement?document.documentElement.scrollHeight:0;this._cover.style.height=Math.max(n,t)+"px";document.body.appendChild(this._cover)}};scheduler.save_lightbox=function(){var n=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));(!this.checkEvent("onEventSave")||this.callEvent("onEventSave",[this._lightbox_id,n,this._new_event]))&&(this._empty_lightbox(n),this.hide_lightbox())};scheduler.startLightbox=function(n,t){this._lightbox_id=n;this._custom_lightbox=!0;this._temp_lightbox=this._lightbox;this._lightbox=t;this.showCover(t)};scheduler.endLightbox=function(n,t){var t=t||scheduler.getLightbox(),i=scheduler.getEvent(this._lightbox_id);i&&this._edit_stop_event(i,n);n&&scheduler.render_view_data();this.hideCover(t);this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1);this._temp_lightbox=this._lightbox_id=null;this._waiAria.lightboxHiddenAttr(t);this.callEvent("onAfterLightbox",[])};scheduler.resetLightbox=function(){scheduler._lightbox&&!scheduler._custom_lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox);scheduler._lightbox=null};scheduler.cancel_lightbox=function(){this.callEvent("onEventCancel",[this._lightbox_id,this._new_event]);this.hide_lightbox()};scheduler._init_lightbox_events=function(){this.getLightbox().onclick=function(n){var t=n?n.target:event.srcElement,i,f,r,e,u;if((t.className||(t=t.previousSibling),!(t&&t.className&&scheduler._getClassName(t).indexOf("dhx_btn_set")>-1)||(t=t.querySelector("[dhx_button]")))&&(i=scheduler._getClassName(t),t&&i))switch(i){case"dhx_save_btn":scheduler.save_lightbox();break;case"dhx_delete_btn":f=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(f,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(scheduler._lightbox_id);scheduler._new_event=null;scheduler.hide_lightbox()});break;case"dhx_cancel_btn":scheduler.cancel_lightbox();break;default:t.getAttribute("dhx_button")?scheduler.callEvent("onLightboxButton",[i,t,n]):(-1!=i.indexOf("dhx_custom_button")&&(-1!=i.indexOf("dhx_custom_button_")?(r=t.parentNode.getAttribute("index"),u=t.parentNode.parentNode):(r=t.getAttribute("index"),u=t.parentNode,t=t.firstChild)),r&&(e=scheduler.form_blocks[scheduler.config.lightbox.sections[r].type],e.button_click(r,t,u,u.nextSibling)))}};this.getLightbox().onkeydown=function(n){var i=n||window.event,r=n.target||n.srcElement,t=r.querySelector("[dhx_button]");switch(t||(t=r.parentNode.querySelector(".dhx_custom_button, .dhx_readonly")),(n||i).keyCode){case 32:if((n||i).shiftKey)return;t&&t.click&&t.click();break;case scheduler.keys.edit_save:if((n||i).shiftKey)return;t&&t.click?t.click():scheduler.save_lightbox();break;case scheduler.keys.edit_cancel:scheduler.cancel_lightbox()}}};scheduler.setLightboxSize=function(){var t=this._lightbox,n;t&&(n=t.childNodes[1],n.style.height="0px",n.style.height=n.scrollHeight+"px",t.style.height=n.scrollHeight+scheduler.xy.lightbox_additional_height+"px",n.style.height=n.scrollHeight+"px")};scheduler._init_dnd_events=function(){dhtmlxEvent(document.body,"mousemove",scheduler._move_while_dnd);dhtmlxEvent(document.body,"mouseup",scheduler._finish_dnd);scheduler._init_dnd_events=function(){}};scheduler._move_while_dnd=function(n){if(scheduler._dnd_start_lb){document.dhx_unselectable||(document.body.className+=" dhx_unselectable",document.dhx_unselectable=!0);var t=scheduler.getLightbox(),i=n&&n.target?[n.pageX,n.pageY]:[event.clientX,event.clientY];t.style.top=scheduler._lb_start[1]+i[1]-scheduler._dnd_start_lb[1]+"px";t.style.left=scheduler._lb_start[0]+i[0]-scheduler._dnd_start_lb[0]+"px"}};scheduler._ready_to_dnd=function(n){var t=scheduler.getLightbox();scheduler._lb_start=[parseInt(t.style.left,10),parseInt(t.style.top,10)];scheduler._dnd_start_lb=n&&n.target?[n.pageX,n.pageY]:[event.clientX,event.clientY]};scheduler._finish_dnd=function(){scheduler._lb_start&&(scheduler._lb_start=scheduler._dnd_start_lb=!1,document.body.className=document.body.className.replace(" dhx_unselectable",""),document.dhx_unselectable=!1)};scheduler.getLightbox=function(){var t,i,o,s,f,e,h,n,c,l;if(!this._lightbox){t=document.createElement("div");t.className="dhx_cal_light";scheduler.config.wide_form&&(t.className+=" dhx_cal_light_wide");scheduler.form_blocks.recurring&&(t.className+=" dhx_cal_light_rec");/msie|MSIE 6/.test(navigator.userAgent)&&(t.className+=" dhx_ie6");t.style.visibility="hidden";for(var u=this._lightbox_template,r=this.config.buttons_left,f="",n=0;n<r.length;n++)f=this._waiAria.lightboxButtonAttrString(r[n]),u+="<div "+f+" class='dhx_btn_set dhx_left_btn_set "+r[n]+"_set'><div dhx_button='1' class='"+r[n]+"'><\/div><div>"+scheduler.locale.labels[r[n]]+"<\/div><\/div>";for(r=this.config.buttons_right,n=0;n<r.length;n++)f=this._waiAria.lightboxButtonAttrString(r[n]),u+="<div "+f+" class='dhx_btn_set dhx_right_btn_set "+r[n]+"_set' style='float:right;'><div dhx_button='1' class='"+r[n]+"'><\/div><div>"+scheduler.locale.labels[r[n]]+"<\/div><\/div>";for(u+="<\/div>",t.innerHTML=u,scheduler.config.drag_lightbox&&(t.firstChild.onmousedown=scheduler._ready_to_dnd,t.firstChild.onselectstart=function(){return!1},t.firstChild.style.cursor="move",scheduler._init_dnd_events()),this._waiAria.lightboxAttr(t),document.body.insertBefore(t,document.body.firstChild),this._lightbox=t,i=this.config.lightbox.sections,u="",n=0;n<i.length;n++)o=this.form_blocks[i[n].type],o&&(i[n].id="area_"+this.uid(),s="",i[n].button&&(f=scheduler._waiAria.lightboxSectionButtonAttrString(this.locale.labels["button_"+i[n].button]),s="<div "+f+" class='dhx_custom_button' index='"+n+"'><div class='dhx_custom_button_"+i[n].button+"'><\/div><div>"+this.locale.labels["button_"+i[n].button]+"<\/div><\/div>"),this.config.wide_form&&(u+="<div class='dhx_wrap_section'>"),e=this.locale.labels["section_"+i[n].name],"string"!=typeof e&&(e=i[n].name),u+="<div id='"+i[n].id+"' class='dhx_cal_lsection'>"+s+"<label>"+e+"<\/label><\/div>"+o.render.call(this,i[n]),u+="<\/div>");for(h=t.getElementsByTagName("div"),n=0;n<h.length;n++)if(c=h[n],l=scheduler._getClassName(c),"dhx_cal_larea"==l){c.innerHTML=u;break}scheduler._bindLightboxLabels(i);this.setLightboxSize();this._init_lightbox_events(this);t.style.display="none";t.style.visibility="visible"}return this._lightbox};scheduler._bindLightboxLabels=function(n){for(var t,f,r,o,u=0;u<n.length;u++)if(t=n[u],t.id&&document.getElementById(t.id)){for(var s=document.getElementById(t.id),e=s.querySelector("label"),i=scheduler._get_lightbox_section_node(t);i&&!i.querySelector;)i=i.nextSibling;f=!0;i&&(r=i.querySelector("input, select, textarea"),r&&(t.inputId=r.id||"input_"+scheduler.uid(),r.id||(r.id=t.inputId),e.setAttribute("for",t.inputId),f=!1));f&&(o=scheduler.form_blocks[t.type],o.focus&&(e.onclick=function(n){return function(){var t=scheduler.form_blocks[n.type],i=scheduler._get_lightbox_section_node(n);t&&t.focus&&t.focus.call(scheduler,i)}}(t)))}};scheduler.attachEvent("onEventIdChange",function(n,t){this._lightbox_id==n&&(this._lightbox_id=t)});scheduler._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;<\/span><span class='dhx_time'><\/span><span class='dhx_title'><\/span><\/div><div class='dhx_cal_larea'><\/div>";scheduler._init_touch_events=function(){var t=this.config.touch&&(-1!=navigator.userAgent.indexOf("Mobile")||-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("Android")||-1!=navigator.userAgent.indexOf("Touch")),n;if(t&&(this.xy.scroll_width=0,this._mobile=!0),this.config.touch){n=!0;try{document.createEvent("TouchEvent")}catch(i){n=!1}n?this._touch_events(["touchmove","touchstart","touchend"],function(n){return n.touches&&n.touches.length>1?null:n.touches[0]?{target:n.target,pageX:n.touches[0].pageX,pageY:n.touches[0].pageY,clientX:n.touches[0].clientX,clientY:n.touches[0].clientY}:n},function(){return!1}):window.PointerEvent||window.navigator.pointerEnabled?this._touch_events(["pointermove","pointerdown","pointerup"],function(n){return"mouse"==n.pointerType?null:n},function(n){return!n||"mouse"==n.pointerType}):window.navigator.msPointerEnabled&&this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(n){return n.pointerType==n.MSPOINTER_TYPE_MOUSE?null:n},function(n){return!n||n.pointerType==n.MSPOINTER_TYPE_MOUSE})}};scheduler._touch_events=function(n,t,i){function o(n,t,r){n.addEventListener(t,function(n){return scheduler._is_lightbox_open()?!0:i(n)?void 0:r(n)},{passive:!1})}function a(n,t,i,r){var u,f,e;if(!n||!t)return!1;for(u=n.target;u&&u!=scheduler._obj;)u=u.parentNode;return u!=scheduler._obj?!1:(f=Math.abs(n.pageY-t.pageY),e=Math.abs(n.pageX-t.pageX),r>f&&e>i&&(!f||e/f>3)?(n.pageX>t.pageX?scheduler._click.dhx_cal_next_button():scheduler._click.dhx_cal_prev_button(),!0):!1)}function v(n){if(!i(n)){var r=scheduler.getState().drag_mode,t=scheduler.matrix?scheduler.matrix[scheduler._mode]:!1,u=scheduler.render_view_data;return"create"==r&&t&&(scheduler.render_view_data=function(){for(var f=scheduler.getState().drag_id,n=scheduler.getEvent(f),u=t.y_property,i=scheduler.getEvents(n.start_date,n.end_date),r=0;r<i.length;r++)i[r][u]!=n[u]&&(i.splice(r,1),r--);n._sorder=i.length-1;n._count=i.length;this.render_data([n],scheduler.getState().mode)}),scheduler._on_mouse_move(n),"create"==r&&t&&(scheduler.render_view_data=u),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,!1}}function s(n){i(n)||(scheduler._hide_global_tip(),u&&(scheduler._on_mouse_up(t(n||event)),scheduler._temp_touch_block=!1),scheduler._drag_id=null,scheduler._drag_mode=null,scheduler._drag_pos=null,scheduler._pointerDragId=null,clearTimeout(c),u=h=!1,e=!0)}var r,f,c,u,e,h,l=(-1!=navigator.userAgent.indexOf("Android")&&-1!=navigator.userAgent.indexOf("WebKit"),0);o(document.body,n[0],function(n){if(!i(n)){var o=t(n);if(o){if(u)return v(o),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,scheduler._update_global_tip(),!1;if(f=t(n),h)return f?void((r.target!=f.target||Math.abs(r.pageX-f.pageX)>5||Math.abs(r.pageY-f.pageY)>5)&&(e=!0,clearTimeout(c))):void(e=!0)}}});o(this._els.dhx_cal_data[0],"scroll",s);o(this._els.dhx_cal_data[0],"touchcancel",s);o(this._els.dhx_cal_data[0],"contextmenu",function(n){if(!i(n))return h?(n&&n.preventDefault&&n.preventDefault(),(n||event).cancelBubble=!0,!1):void 0});o(this._obj,n[1],function(n){var o,s;if(!i(n)){if(scheduler._pointerDragId=n.pointerId,u=e=!1,h=!0,o=f=t(n),!o)return void(e=!0);if(s=new Date,!e&&!u&&250>s-l)return scheduler._click.dhx_cal_data(o),window.setTimeout(function(){o.type="dblclick";scheduler._on_dbl_click(o)},50),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,scheduler._block_next_stop=!0,!1;if(l=s,!e&&!u&&scheduler.config.touch_drag){var a=scheduler._locate_event(document.activeElement),v=scheduler._locate_event(o.target),y=r?scheduler._locate_event(r.target):null;if(a&&v&&a==v&&a!=y)return n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,scheduler._ignore_next_click=!1,scheduler._click.dhx_cal_data(o),r=o,!1;c=setTimeout(function(){u=!0;var n=r.target,t=scheduler._getClassName(n);n&&-1!=t.indexOf("dhx_body")&&(n=n.previousSibling);scheduler._on_mouse_down(r,n);scheduler._drag_mode&&"create"!=scheduler._drag_mode&&scheduler.for_rendered(scheduler._drag_id,function(n,t){n.style.display="none";scheduler._rendered.splice(t,1)});scheduler.config.touch_tip&&scheduler._show_global_tip();scheduler.updateEvent(scheduler._drag_id)},scheduler.config.touch_drag);r=o}}});o(this._els.dhx_cal_data[0],n[2],function(n){if(!i(n))return(!u&&a(r,f,200,100)&&(scheduler._block_next_stop=!0),u&&(scheduler._ignore_next_click=!0,setTimeout(function(){scheduler._ignore_next_click=!1},100)),s(n),scheduler._block_next_stop?(scheduler._block_next_stop=!1,n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,!1):void 0)});dhtmlxEvent(document.body,n[2],s)};scheduler._show_global_tip=function(){scheduler._hide_global_tip();var n=scheduler._global_tip=document.createElement("div");n.className="dhx_global_tip";scheduler._update_global_tip(1);document.body.appendChild(n)};scheduler._update_global_tip=function(n){var r=scheduler._global_tip,i,t;r&&(i="",scheduler._drag_id&&!n&&(t=scheduler.getEvent(scheduler._drag_id),t&&(i="<div>"+(t._timed?scheduler.templates.event_header(t.start_date,t.end_date,t):scheduler.templates.day_date(t.start_date,t.end_date,t))+"<\/div>")),r.innerHTML="create"==scheduler._drag_mode||"new-size"==scheduler._drag_mode?(scheduler.locale.labels.drag_to_create||"Drag to create")+i:(scheduler.locale.labels.drag_to_move||"Drag to move")+i)};scheduler._hide_global_tip=function(){var n=scheduler._global_tip;n&&n.parentNode&&(n.parentNode.removeChild(n),scheduler._global_tip=0)};scheduler._dp_init=function(n){n._methods=["_set_event_text_style","","_dp_change_event_id","_dp_hook_delete"];this._dp_change_event_id=function(n,t){scheduler.getEvent(n)&&scheduler.changeEventId(n,t)};this._dp_hook_delete=function(t,i){if(scheduler.getEvent(t))return(t!=i&&("true_deleted"==this.getUserData(t,n.action_param)&&this.setUserData(t,n.action_param,"updated"),this.changeEventId(t,i)),this.deleteEvent(i,!0))};this.attachEvent("onEventAdded",function(t){!this._loading&&this._validId(t)&&n.setUpdated(t,!0,"inserted")});this.attachEvent("onConfirmedBeforeEventDelete",function(t){if(this._validId(t)){var i=n.getState(t);return"inserted"==i||this._new_event?(n.setUpdated(t,!1),!0):"deleted"==i?!1:"true_deleted"==i?!0:(n.setUpdated(t,!0,"deleted"),!1)}});this.attachEvent("onEventChanged",function(t){!this._loading&&this._validId(t)&&n.setUpdated(t,!0,"updated")});scheduler.attachEvent("onClearAll",function(){n._in_progress={};n._invalid={};n.updatedRows=[];n._waitMode=0});n._objToJson=function(t,i,r){r=r||"";i=i||{};for(var u in t)0!==u.indexOf("_")&&(t[u]&&t[u].getUTCFullYear?i[r+u]=this.obj.templates.xml_format(t[u]):t[u]&&"object"==typeof t[u]?n._objToJson(t[u],i,r+u+"."):i[r+u]=t[u]);return i};n._getRowData=function(n){var t=this.obj.getEvent(n);return this._objToJson(t)};n._clearUpdateFlag=function(){};n.attachEvent("insertCallback",scheduler._update_callback);n.attachEvent("updateCallback",scheduler._update_callback);n.attachEvent("deleteCallback",function(n,t){this.obj.getEvent(t)?(this.obj.setUserData(t,this.action_param,"true_deleted"),this.obj.deleteEvent(t)):this.obj._add_rec_marker&&this.obj._update_callback(n,t)})};scheduler._validId=function(){return!0};scheduler.setUserData=function(n,t,i){if(n){var r=this.getEvent(n);r&&(r[t]=i)}else this._userdata[t]=i};scheduler.getUserData=function(n,t){if(n){var i=this.getEvent(n);return i?i[t]:null}return this._userdata[t]};scheduler._set_event_text_style=function(n,t){if(scheduler.getEvent(n)){this.for_rendered(n,function(n){n.style.cssText+=";"+t});var i=this.getEvent(n);i._text_style=t;this.event_updated(i)}};scheduler._update_callback=function(n){var t=scheduler._xmlNodeToJSON(n.firstChild);"none"==t.rec_type&&(t.rec_pattern="none");t.text=t.text||t._tagvalue;t.start_date=scheduler.templates.xml_date(t.start_date);t.end_date=scheduler.templates.xml_date(t.end_date);scheduler.addEvent(t);scheduler._add_rec_marker&&scheduler.setCurrentView()};scheduler._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]};scheduler._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]};scheduler._is_material_skin=function(){return(scheduler.skin+"").indexOf("material")>-1};scheduler._border_box_bvents=function(){return scheduler._is_material_skin()};scheduler._configure=function(n,t,i){for(var r in t)"undefined"==typeof n[r]&&(n[r]=t[r][i])};scheduler._skin_init=function(){var i,t,r,n,u,f,o,e;if(!scheduler.skin)for(i=document.getElementsByTagName("link"),t=0;t<i.length;t++)if(r=i[t].href.match("dhtmlxscheduler_([a-z]+).css"),r){scheduler.skin=r[1];break}n=0;(!scheduler.skin||"classic"!==scheduler.skin&&"glossy"!==scheduler.skin||(n=1),scheduler._is_material_skin())&&(u=scheduler.config.buttons_left.$inital,f=scheduler.config.buttons_right.$inital,u&&scheduler.config.buttons_left.slice().join()==u&&f&&scheduler.config.buttons_right.slice().join()==f&&(o=scheduler.config.buttons_left.slice(),scheduler.config.buttons_left=scheduler.config.buttons_right.slice(),scheduler.config.buttons_right=o),scheduler.xy.event_header_height=18,scheduler.xy.menu_width=25,scheduler.xy.week_agenda_scale_height=35,scheduler.xy.map_icon_width=38,scheduler._lightbox_controls.defaults.textarea.height=64,scheduler._lightbox_controls.defaults.time.height="auto");(this._configure(scheduler.config,scheduler._skin_settings,n),this._configure(scheduler.xy,scheduler._skin_xy,n),"flat"===scheduler.skin&&(scheduler.xy.scale_height=35,scheduler.templates.hour_scale=function(n){var t=n.getMinutes();return t=10>t?"0"+t:t,"<span class='dhx_scale_h'>"+n.getHours()+"<\/span><span class='dhx_scale_m'>&nbsp;"+t+"<\/span>"}),n)||(e=scheduler.config.minicalendar,e&&(e.padding=14),scheduler.templates.event_bar_date=function(n){return" <b>"+scheduler.templates.event_date(n)+"<\/b> "},scheduler.attachEvent("onTemplatesReady",function(){var h=scheduler.date.date_to_str("%d"),e,r,n,u;if(scheduler.templates._old_month_day||(scheduler.templates._old_month_day=scheduler.templates.month_day),e=scheduler.templates._old_month_day,scheduler.templates.month_day=function(n){if("month"==this._mode){var t=h(n);return 1==n.getDate()&&(t=scheduler.locale.date.month_full[n.getMonth()]+" "+t),+n==+scheduler.date.date_part(this._currentDate())&&(t=scheduler.locale.labels.dhx_cal_today_button+" "+t),t}return e.call(this,n)},scheduler.config.fix_tab_position){var o=scheduler._els.dhx_cal_navline[0].getElementsByTagName("div"),f=null,t=211,i=[14,75,136],s=14;for(scheduler._is_material_skin()&&(i=[16,103,192],t=294,s=-1),r=0;r<o.length;r++)if(n=o[r],u=n.getAttribute("name"),u){switch(n.style.right="auto",u){case"day_tab":n.style.left=i[0]+"px";n.className+=" dhx_cal_tab_first";break;case"week_tab":n.style.left=i[1]+"px";break;case"month_tab":n.style.left=i[2]+"px";n.className+=" dhx_cal_tab_last";break;default:n.style.left=t+"px";n.className+=" dhx_cal_tab_standalone";t=t+s+n.offsetWidth}n.className+=" "+u}else 0===(n.className||"").indexOf("dhx_minical_icon")&&n.parentNode==scheduler._els.dhx_cal_navline[0]&&(f=n);f&&(f.style.left=t+"px")}}),scheduler._skin_init=function(){})};window.jQuery&&!function(n){var t=[];n.fn.dhx_scheduler=function(i){if("string"!=typeof i){var r=[];return this.each(function(){if(this&&this.getAttribute&&!this.getAttribute("dhxscheduler")){for(var n in i)"data"!=n&&(scheduler.config[n]=i[n]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;<\/div><div class="dhx_cal_next_button">&nbsp;<\/div><div class="dhx_cal_today_button"><\/div><div class="dhx_cal_date"><\/div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"><\/div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"><\/div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"><\/div><\/div><div class="dhx_cal_header"><\/div><div class="dhx_cal_data"><\/div>',this.className+=" dhx_cal_container");scheduler.init(this,scheduler.config.date,scheduler.config.mode);i.data&&scheduler.parse(i.data);r.push(scheduler)}}),1===r.length?r[0]:r}return t[i]?t[i].apply(this,[]):void n.error("Method "+i+" does not exist on jQuery.dhx_scheduler")}}(jQuery),function(){function i(n,t,i){t&&(n._date=t);i&&(n._mode=i)}var u=scheduler.setCurrentView,r=scheduler.updateView,n=null,t=null,f=function(u,f){var e=this,o,s;window.clearTimeout(t);window.clearTimeout(n);o=e._date;s=e._mode;i(this,u,f);t=setTimeout(function(){return e.callEvent("onBeforeViewChange",[s,o,f||e._mode,u||e._date])?(r.call(e,u,f),e.callEvent("onViewChange",[e._mode,e._date]),window.clearTimeout(n),void(t=0)):void i(e,o,s)},scheduler.config.delay_render)},e=function(u,f){var e=this,o=arguments;i(this,u,f);window.clearTimeout(n);n=setTimeout(function(){t||r.apply(e,o)},scheduler.config.delay_render)};scheduler.attachEvent("onSchedulerReady",function(){scheduler.config.delay_render?(scheduler.setCurrentView=f,scheduler.updateView=e):(scheduler.setCurrentView=u,scheduler.updateView=r)})}();